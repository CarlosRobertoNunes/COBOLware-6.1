<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
        <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
        <TITLE>COBOLware 6.1 - Exemplo de manuten&ccedil;&atilde;o de cadastros</TITLE>
        <META NAME="GENERATOR" CONTENT="BrOffice.org 3.1  (Win32)">
        <META NAME="CREATED" CONTENT="20070715;23051700">
        <META NAME="CHANGEDBY" CONTENT="Carlos Roberto de Souza Nunes">
        <META NAME="CHANGED" CONTENT="20150814;530400">
        <STYLE TYPE="text/css">
        <!--
                P { color: #000000; font-family: "Courier New" }
                PRE { color: #000000 }
        -->
        </STYLE>
</HEAD>
<BODY LANG="pt-BR" TEXT="#000000" DIR="LTR">
<PRE>       IDENTIFICATION DIVISION.
       PROGRAM-ID.    <FONT COLOR="#ff0000">CWCADS</FONT>.
       AUTHOR.        COBOLware Services Ltda.
       DATE-WRITTEN.  <FONT COLOR="#ff0000">99/99/9999</FONT>.
       SECURITY.      <FONT COLOR="#ff0000">*************************************************</FONT>
<FONT COLOR="#ff0000">                      *                                               *</FONT>
<FONT COLOR="#ff0000">                      *  Exemplo de cadastro                          *</FONT>
<FONT COLOR="#ff0000">                      *                                               *</FONT>
<FONT COLOR="#ff0000">                      *************************************************</FONT>
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.

           SELECT <FONT COLOR="#008000">FileName</FONT> ASSIGN TO DISK
                  ORGANIZATION  IS INDEXED
                  ACCESS MODE   IS DYNAMIC
                  RECORD  KEY   IS <FONT COLOR="#008000">FileName-CHAVE</FONT>
                  ALTERNATE RECORD KEY IS <FONT COLOR="#008000">FileName-DESCRICAO</FONT>
                                          WITH DUPLICATES
                  LOCK MODE     IS MANUAL
                  FILE STATUS   IS <FONT COLOR="#008000">FS-FileName</FONT>.

       DATA DIVISION.
       FILE SECTION.

       FD  <FONT COLOR="#008000">FileName</FONT>
           LABEL RECORD IS STANDARD
           VALUE OF FILE-ID IS <FONT COLOR="#008000">LB-FileName</FONT>.

       01  <FONT COLOR="#008000">FileName-REG</FONT>.
           05 <FONT COLOR="#008000">FileName-CHAVE</FONT>.
              10 <FONT COLOR="#008000">FileName-CODIGO</FONT>          PIC  9(005).
           05 <FONT COLOR="#008000">FileName-DESCRICAO</FONT>          PIC  X(030).
           05 <FONT COLOR="#008000">FileName-PRECO</FONT>              PIC  9(008)V99.
           05 <FONT COLOR="#008000">FileName-TIPO</FONT>               PIC  9(001).
              88 <FONT COLOR="#ff00ff">FileName-PECA</FONT>                         VALUE <FONT COLOR="#ff0000">1</FONT>.
              88 <FONT COLOR="#ff00ff">FileName-ACABADO</FONT>                      VALUE <FONT COLOR="#ff0000">2</FONT>.
              88 <FONT COLOR="#ff00ff">FileName-MATERIAL</FONT>                     VALUE <FONT COLOR="#ff0000">3</FONT>.
           05 <FONT COLOR="#008000">FileName-OPCOES</FONT>.
              10 <FONT COLOR="#ff00ff">FileName-IMPORTADO</FONT>       PIC  9(001).
              10 <FONT COLOR="#ff00ff">FileName-GARANTIA</FONT>        PIC  9(001).
              10 <FONT COLOR="#ff00ff">FileName-DURAVEL</FONT>         PIC  9(001).

       WORKING-STORAGE SECTION.

       01  <FONT COLOR="#008000">AREAS-DE-TRABALHO-1</FONT>.
           05 <FONT COLOR="#008000">TIPOS</FONT>.
              10 <FONT COLOR="#008080">CWRADIO</FONT>      OCCURS <FONT COLOR="#ff0000">3</FONT> PIC  9(001).
           05 <FONT COLOR="#008000">OPCOES</FONT>.
              10 <FONT COLOR="#008080">CWCHECK</FONT>      OCCURS <FONT COLOR="#ff0000">3</FONT> PIC  9(001).
           05 <FONT COLOR="#008000">MENSAGEM</FONT>                 PIC  X(074) VALUE SPACES.
           05 <FONT COLOR="#008000">POSICIONA</FONT>                PIC  9(001) VALUE ZERO.
           05 <FONT COLOR="#008000">ERRO</FONT>                     PIC  9(001) VALUE ZERO.
           05 <FONT COLOR="#008000">CHAVE</FONT>                    PIC  9(002) VALUE ZERO.
           05 <FONT COLOR="#008000">CHAVE-ANTERIOR</FONT>           PIC  9(002) VALUE ZERO.
           05 <FONT COLOR="#008000">CAMPO</FONT>                    PIC  9(002) VALUE ZERO.
           05 <FONT COLOR="#008000">SALVA-REG</FONT>                PIC X(4096) VALUE ZERO.
           05 <FONT COLOR="#008000">SALVA-CHAVE</FONT>              PIC  X(255) VALUE SPACES.
           05 <FONT COLOR="#008000">TECLA</FONT>                    PIC  9(003) VALUE ZERO.
              COPY <A HREF="CWKEYS.CPY"><FONT COLOR="#008080">CWKEYS</FONT></A>.
           05 <FONT COLOR="#008000">FUNCAO-ANTERIOR</FONT>          PIC  X(001) VALUE SPACE.
           05 <FONT COLOR="#008000">FS-FileName</FONT>              PIC  X(002) VALUE &quot;<FONT COLOR="#ff0000">00</FONT>&quot;.
           05 <FONT COLOR="#008000">LB-FileName</FONT>              PIC  X(255) VALUE &quot;<FONT COLOR="#ff0000">FileName</FONT>&quot;.

       COPY <A HREF="CWFUNC.CPY"><FONT COLOR="#008080">CWFUNC</FONT></A>.

       SCREEN SECTION.

       01  <A HREF="ctac.html"><FONT COLOR="#008080">CTAC</FONT></A><FONT COLOR="#008000">-LIT-CWCADS</FONT>.
           05 LINE <FONT COLOR="#ff0000">08</FONT> COLUMN <FONT COLOR="#ff0000">03</FONT> VALUE &quot;<FONT COLOR="#ff0000">C&oacute;digo</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">10</FONT> COLUMN <FONT COLOR="#ff0000">03</FONT> VALUE &quot;<FONT COLOR="#ff0000">Descri&ccedil;&atilde;o</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">12</FONT> COLUMN <FONT COLOR="#ff0000">03</FONT> VALUE &quot;<FONT COLOR="#ff0000">Valor</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">15</FONT> COLUMN <FONT COLOR="#ff0000">08</FONT> VALUE &quot;<FONT COLOR="#ff0000">Pe&ccedil;a</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">15</FONT> COLUMN <FONT COLOR="#ff0000">17</FONT> VALUE &quot;<FONT COLOR="#ff0000">Acabado</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">15</FONT> COLUMN <FONT COLOR="#ff0000">29</FONT> VALUE &quot;<FONT COLOR="#ff0000">Material</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">19</FONT> COLUMN <FONT COLOR="#ff0000">08</FONT> VALUE &quot;<FONT COLOR="#ff0000">Importado</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">19</FONT> COLUMN <FONT COLOR="#ff0000">22</FONT> VALUE &quot;<FONT COLOR="#ff0000">Garantia</FONT>&quot;.
           05 LINE <FONT COLOR="#ff0000">19</FONT> COLUMN <FONT COLOR="#ff0000">35</FONT> VALUE &quot;<FONT COLOR="#ff0000">Dur&aacute;vel</FONT>&quot;.

       01  <A HREF="ctac.html"><FONT COLOR="#008080">CTAC</FONT></A><FONT COLOR="#008000">-VAR-CWCADS</FONT>.
           05 <FONT COLOR="#008000">TELA-CHAVE</FONT>.
              10 LINE <FONT COLOR="#ff0000">08</FONT> COLUMN <FONT COLOR="#ff0000">13</FONT> PIC Z(005) USING <FONT COLOR="#008000">FileName-CODIGO</FONT>.
           05 <FONT COLOR="#008000">TELA-DADOS</FONT>.
<A NAME="FileName-DESCRICAO"></A>              10 LINE <FONT COLOR="#ff0000">10</FONT> COLUMN <FONT COLOR="#ff0000">13</FONT> PIC X(030) USING <FONT COLOR="#008000">FileName-DESCRICAO</FONT>.
              10 LINE <FONT COLOR="#ff0000">12</FONT> COLUMN <FONT COLOR="#ff0000">13</FONT> PIC ZZ.ZZZ.ZZ9,99
<A NAME="FileName-PRECO"></A>                 USING <FONT COLOR="#008000">FileName-PRECO</FONT>.
<A NAME="CWRADIO"></A>              10 LINE <FONT COLOR="#ff0000">15</FONT> COLUMN <FONT COLOR="#ff0000">05</FONT> PIC X(001) USING <FONT COLOR="#008080">CWRADIO</FONT>(<FONT COLOR="#ff0000">1</FONT>).
              10 LINE <FONT COLOR="#ff0000">15</FONT> COLUMN <FONT COLOR="#ff0000">14</FONT> PIC X(001) USING <FONT COLOR="#008080">CWRADIO</FONT>(<FONT COLOR="#ff0000">2</FONT>).
              10 LINE <FONT COLOR="#ff0000">15</FONT> COLUMN <FONT COLOR="#ff0000">26</FONT> PIC X(001) USING <FONT COLOR="#008080">CWRADIO</FONT>(<FONT COLOR="#ff0000">3</FONT>).
              10 LINE <FONT COLOR="#ff0000">19</FONT> COLUMN <FONT COLOR="#ff0000">05</FONT> PIC X(001) USING <FONT COLOR="#008080">CWCHECK</FONT>(<FONT COLOR="#ff0000">1</FONT>).
              10 LINE <FONT COLOR="#ff0000">19</FONT> COLUMN <FONT COLOR="#ff0000">19</FONT> PIC X(001) USING <FONT COLOR="#008080">CWCHECK</FONT>(<FONT COLOR="#ff0000">2</FONT>).
              10 LINE <FONT COLOR="#ff0000">19</FONT> COLUMN <FONT COLOR="#ff0000">32</FONT> PIC X(001) USING <FONT COLOR="#008080">CWCHECK</FONT>(<FONT COLOR="#ff0000">3</FONT>).

       01  <FONT COLOR="#008000">TELA-DESCRICAO</FONT>.
           <FONT COLOR="#ff0000">10</FONT> LINE <FONT COLOR="#ff0000">10</FONT> COLUMN <FONT COLOR="#ff0000">13</FONT> PIC X(030) USING <FONT COLOR="#008000">FileName-DESCRICAO</FONT>.

       PROCEDURE DIVISION.

       000-INICIO.

           OPEN INPUT FileName

           IF   <FONT COLOR="#008000">FS-FileName</FONT> = &quot;<FONT COLOR="#ff0000">30</FONT>&quot; OR &quot;<FONT COLOR="#ff0000">35</FONT>&quot;
                OPEN OUTPUT <FONT COLOR="#008000">FileName</FONT>
                CLOSE <FONT COLOR="#008000">FileName</FONT>
           ELSE
                IF   <FONT COLOR="#008000">FS-FileName</FONT> &lt; &quot;<FONT COLOR="#ff0000">10</FONT>&quot;
                     CLOSE <FONT COLOR="#008000">FileName</FONT>
                ELSE
                     GOBACK
                END-IF
           END-IF

           OPEN I-O <FONT COLOR="#008000">FileName</FONT>

           PERFORM <FONT COLOR="#008000">110-GRUPO</FONT> THRU <FONT COLOR="#008000">110-99-FIM</FONT>
           INITIALIZE <FONT COLOR="#008000">FileName-REG</FONT>
           DISPLAY <A HREF="ctac.html"><FONT COLOR="#008080">CTAC</FONT></A><FONT COLOR="#008000">-LIT-CWCADS</FONT>
           PERFORM <FONT COLOR="#008000">111-EXIBE</FONT> THRU <FONT COLOR="#008000">111-99-FIM</FONT>

           PERFORM TEST AFTER UNTIL <FONT COLOR="#ff00ff">FINALIZAR</FONT>
                   PERFORM <FONT COLOR="#008000">110-GRUPO</FONT> THRU <FONT COLOR="#008000">110-99-FIM</FONT>
                   IF   <FONT COLOR="#008000">FUNCAO</FONT> = SPACE
                        MOVE <FONT COLOR="#ff0000">0</FONT> TO <FONT COLOR="#008000">CHAVE</FONT>
                   END-IF
                   EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="opti.html"><FONT COLOR="#008080">Option</FONT></A>
                        <FONT COLOR="#008080">Function</FONT> <FONT COLOR="#008000">FUNCAO</FONT>
                   END-EXEC
                   IF  NOT <FONT COLOR="#ff00ff">FINALIZAR</FONT>
                       PERFORM <FONT COLOR="#008000">100-PROCESSAMENTO</FONT> THRU <FONT COLOR="#008000">100-99-FIM</FONT>
                   END-IF
           END-PERFORM

           CLOSE <FONT COLOR="#008000">FileName</FONT>

           IF   <FONT COLOR="#ff00ff">PARAR</FONT>
                STOP RUN
           ELSE
                EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="pict.html"><FONT COLOR="#008080">Picture</FONT></A> <FONT COLOR="#008080">Erase</FONT>
                          <FONT COLOR="#008080">LINE</FONT> <FONT COLOR="#ff0000">9</FONT> <FONT COLOR="#008080">COLUMN</FONT> <FONT COLOR="#ff0000">52</FONT>
                END-EXEC
                GOBACK
           END-IF.

       <FONT COLOR="#008000">100-PROCESSAMENTO</FONT>.

           PERFORM <FONT COLOR="#008000">110-GRUPO</FONT> THRU <FONT COLOR="#008000">110-99-FIM</FONT>
           COPY <A HREF="CWESCP.CPY"><FONT COLOR="#008080">CWESCP</FONT></A>.

           PERFORM TEST AFTER
                   UNTIL(NOT (<FONT COLOR="#008080">PAGE-UP</FONT>   AND <FONT COLOR="#ff00ff">PAGE-UP-OFF</FONT>))
                     AND(NOT (<FONT COLOR="#008080">PAGE-DOWN </FONT>AND <FONT COLOR="#ff00ff">PAGE-DOWN-OFF</FONT>))
                   EVALUATE TRUE
                       WHEN <FONT COLOR="#ff00ff">INCLUSAO</FONT>
                            PERFORM <FONT COLOR="#008000">140-NOVA-CHAVE</FONT> THRU <FONT COLOR="#008000">140-99-FIM</FONT>
                            ACCEPT <FONT COLOR="#008000">TELA-CHAVE</FONT>
                            IF   <FONT COLOR="#008000">FileName-CHAVE</FONT> = <FONT COLOR="#008000">SALVA-CHAVE</FONT>
                                 PERFORM <FONT COLOR="#008000">140-NOVA-CHAVE</FONT> THRU <FONT COLOR="#008000">140-99-FIM</FONT>
                            END-IF
                       WHEN <FONT COLOR="#ff00ff">ALTERACAO</FONT> OR <FONT COLOR="#ff00ff">EXCLUSAO</FONT> OR <FONT COLOR="#ff00ff">CONSULTA</FONT>
                            COPY <A HREF="CWPGON.CPY"><FONT COLOR="#008080">CWPGON</FONT></A>.
                            MOVE <FONT COLOR="#ff0000">0</FONT>            TO <FONT COLOR="#008000">POSICIONA</FONT>
                            MOVE <FONT COLOR="#008000">FileName-REG</FONT> TO <FONT COLOR="#008000">SALVA-REG</FONT>
                            PERFORM UNTIL <FONT COLOR="#008000">CHAVE</FONT> NOT = <FONT COLOR="#ff0000">0</FONT>
                                    EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="boxs.html"><FONT COLOR="#008080">BoxSelect</FONT></A>
                                         <FONT COLOR="#008080">TITLE</FONT> &quot;<FONT COLOR="#ff0000">Pesquisar:</FONT>&quot;
                                         <FONT COLOR="#008080">LINE</FONT> <FONT COLOR="#ff0000">10</FONT> COLUMN <FONT COLOR="#ff0000">10</FONT>
                                         <FONT COLOR="#008080">TEXT</FONT>(<FONT COLOR="#ff0000">1</FONT>) &quot;<FONT COLOR="#ff0000">~C&cent;digo</FONT>&quot;
                                         <FONT COLOR="#008080">TEXT</FONT>(2) &quot;<FONT COLOR="#ff0000">~Descri&ccedil;&atilde;o</FONT>&quot;
                                         <FONT COLOR="#008080">OPTION</FONT> <FONT COLOR="#008000">CHAVE</FONT>;<FONT COLOR="#008000">CHAVE</FONT>
                                    END-EXEC
                                    MOVE <FONT COLOR="#008000">CHAVE</FONT> TO <FONT COLOR="#008000">POSICIONA</FONT>
                                    IF  <FONT COLOR="#008000">CHAVE</FONT> = <FONT COLOR="#ff0000">0</FONT>
                                        MOVE <FONT COLOR="#ff0000">99</FONT>    TO <FONT COLOR="#008000">CHAVE</FONT>
                                        MOVE SPACE TO <FONT COLOR="#008000">FUNCAO</FONT>
                                    END-IF
                            END-PERFORM
                            EVALUATE <FONT COLOR="#008000">CHAVE</FONT>
                                WHEN <FONT COLOR="#ff0000">1</FONT>
                                     EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> <FONT COLOR="#008080">COMBO-BOX</FONT>
                                          <FONT COLOR="#008080">LINE</FONT> <FONT COLOR="#ff0000">08</FONT> <FONT COLOR="#008080">COLUMN</FONT> <FONT COLOR="#ff0000">13</FONT>
<FONT COLOR="#ff0000">                                         </FONT> <FONT COLOR="#008080">HEIGHT</FONT> <FONT COLOR="#ff0000">10</FONT> <FONT COLOR="#008080">WIDTH</FONT> <FONT COLOR="#ff0000">5</FONT>
                                          <FONT COLOR="#008080">PROVIDER</FONT> &quot;<A HREF="cwcad3.html">CWCAD3</A>&quot;
                                          <FONT COLOR="#008080">FIELD</FONT> <FONT COLOR="#008000">Filename-CODIGO</FONT>
                                          <FONT COLOR="#008080">ORDER-LEFT RETURN-LEFT</FONT>
<FONT COLOR="#008080">                                          LEFT-WIDTH</FONT>  <FONT COLOR="#ff0000">6</FONT>
                                          <FONT COLOR="#008080">RIGHT-WIDTH</FONT> <FONT COLOR="#ff0000">30</FONT>
                                     END-EXEC
                                     ACCEPT <FONT COLOR="#008000">TELA-CHAVE</FONT>
                                WHEN <FONT COLOR="#ff0000">2</FONT>
                                     EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> <FONT COLOR="#008080">COMBO-BOX</FONT>
<FONT COLOR="#008080">                                          LINE </FONT><FONT COLOR="#ff0000">10</FONT><FONT COLOR="#008080"> COLUMN </FONT><FONT COLOR="#ff0000">13</FONT>
<FONT COLOR="#ff0000">                                         </FONT><FONT COLOR="#008080"> HEIGHT </FONT><FONT COLOR="#ff0000">10</FONT><FONT COLOR="#008080"> WIDTH </FONT><FONT COLOR="#ff0000">30</FONT>
                                          <FONT COLOR="#008080">PROVIDER</FONT> &quot;<A HREF="cwcad3.html">CWCAD3</A>&quot;
                                          <FONT COLOR="#008080">FIELD </FONT><FONT COLOR="#008000">Filename-DESCRICAO</FONT>
<FONT COLOR="#008080">                                          ORDER-RIGHT RETURN-RIGHT</FONT>
<FONT COLOR="#008080">                                          RIGHT-WIDTH </FONT><FONT COLOR="#ff0000">30</FONT>
                                     END-EXEC
                                     ACCEPT <FONT COLOR="#008000">TELA-DESCRICAO</FONT>
                            END-EVALUATE
                            PERFORM <FONT COLOR="#008000">110-GRUPO</FONT> THRU <FONT COLOR="#008000">110-99-FIM</FONT>
                            IF   <FONT COLOR="#008000">FileName-REG</FONT> = <FONT COLOR="#008000">SALVA-REG</FONT>
                            AND  <FONT COLOR="#008000">CHAVE</FONT>        = <FONT COLOR="#008000">CHAVE-ANTERIOR</FONT>
                            AND  <FONT COLOR="#008000">FUNCAO</FONT>       = <FONT COLOR="#008000">FUNCAO-ANTERIOR</FONT>
                                 MOVE <FONT COLOR="#ff0000">0</FONT> TO <FONT COLOR="#008000">POSICIONA</FONT>
                            END-IF
                            MOVE <FONT COLOR="#008000">CHAVE</FONT>  TO <FONT COLOR="#008000">CHAVE-ANTERIOR</FONT>
                            MOVE <FONT COLOR="#008000">FUNCAO</FONT> TO <FONT COLOR="#008000">FUNCAO-ANTERIOR</FONT>
                            IF  (<FONT COLOR="#008000">POSICIONA</FONT>    NOT = <FONT COLOR="#ff0000">0)</FONT>
                            OR  (<FONT COLOR="#008000">FileName-REG</FONT> NOT = <FONT COLOR="#008000">SALVA-REG)</FONT>
                                 MOVE <FONT COLOR="#ff0000">1</FONT> TO <FONT COLOR="#008000">POSICIONA</FONT>
                                 SET <FONT COLOR="#008080">PAGE-UP-ON</FONT>   TO TRUE
                                 SET <FONT COLOR="#008080">PAGE-DOWN-ON</FONT> TO TRUE
                                 SET <FONT COLOR="#ff00ff">READY-OFF</FONT>    TO TRUE
                                 EVALUATE <FONT COLOR="#008000">CHAVE</FONT>
                                     WHEN <FONT COLOR="#ff0000">1</FONT>
                                    START <FONT COLOR="#008000">FileName</FONT> KEY
                                          NOT &lt; <FONT COLOR="#008000">FileName-CHAVE</FONT>
                                          INVALID KEY
                                                  START <FONT COLOR="#008000">FileName</FONT> KEY
                                                  NOT &gt; <FONT COLOR="#008000">FileName-CHAVE</FONT>
                                          END-START
                                    END-START
                                     WHEN <FONT COLOR="#ff0000">2</FONT>
                                    START <FONT COLOR="#008000">FileName</FONT> KEY
                                          NOT &lt; <FONT COLOR="#008000">FileName-DESCRICAO</FONT>
                                          INVALID KEY
                                                <FONT COLOR="#008000">START FileName </FONT><FONT COLOR="#000000">KEY</FONT>
                                                NOT &gt; <FONT COLOR="#008000">FileName-DESCRICAO</FONT>
                                          END-START
                                    END-START
                                 END-EVALUATE
                            END-IF
                   END-EVALUATE
                   IF   <FONT COLOR="#008000">POSICIONA</FONT> = <FONT COLOR="#ff0000">0</FONT>
                        ACCEPT <FONT COLOR="#008000">TECLA</FONT> FROM ESCAPE KEY
                   ELSE
                        SET <FONT COLOR="#ff00ff">PAGE-DOWN</FONT> TO TRUE
                        EXIT PERFORM
                   END-IF
           END-PERFORM

           MOVE SPACES TO MENSAGEM<BR>
           EVALUATE TRUE
               WHEN <FONT COLOR="#008080">ESC</FONT>
                    MOVE SPACE TO FUNCAO
               WHEN <FONT COLOR="#ff00ff">INCLUSAO</FONT>
                AND <FONT COLOR="#008000">FileName-CODIGO</FONT> = <FONT COLOR="#ff0000">0</FONT>
                    EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="send.html"><FONT COLOR="#008080">Send</FONT></A>
                         <FONT COLOR="#008080">Message</FONT> &quot;<FONT COLOR="#ff0000">Informe c&cent;digo do produto</FONT>&quot;
                    END-EXEC
               WHEN <FONT COLOR="#ff00ff">INCLUSAO</FONT>
                    READ <FONT COLOR="#008000">FileName</FONT>
                    IF   <FONT COLOR="#008000">FS-FileName</FONT> &lt; &quot;10&quot;
                         PERFORM <FONT COLOR="#008000">111-EXIBE</FONT> THRU <FONT COLOR="#008000">111-99-FIM</FONT>
                         EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="send.html"><FONT COLOR="#008080">Send</FONT></A>
                              <FONT COLOR="#008080">Message</FONT> &quot;<FONT COLOR="#ff0000">Produto j&aacute; cadastrado</FONT>&quot;
                         END-EXEC
                    ELSE
                         IF   <FONT COLOR="#008000">FS-FileName</FONT> = &quot;<FONT COLOR="#ff0000">23</FONT>&quot;
                              WRITE <FONT COLOR="#008000">FileName-REG</FONT>
                              READ <FONT COLOR="#008000">FileName</FONT> WITH LOCK
                              PERFORM <FONT COLOR="#008000">120-CRITICA</FONT> THRU <FONT COLOR="#008000">120-99-FIM</FONT>
                              IF   <FONT COLOR="#ff00ff">EFETIVAR</FONT>
                                   REWRITE <FONT COLOR="#008000">FileName-REG</FONT>
                                   UNLOCK <FONT COLOR="#008000">FileName</FONT>
                              ELSE
                                   EXEC<FONT COLOR="#008080"> COBOLware</FONT> <A HREF="pict.html"><FONT COLOR="#008080">Picture</FONT></A> <FONT COLOR="#008080">Erase</FONT>
                          <FONT COLOR="#008080">                   LINE</FONT> <FONT COLOR="#ff0000">9</FONT> <FONT COLOR="#008080">COLUMN</FONT> <FONT COLOR="#ff0000">52</FONT>
                                   END-EXEC
                                   DELETE <FONT COLOR="#008000">FileName</FONT> RECORD
                                   EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="pict.html"><FONT COLOR="#008080">Picture</FONT></A> <FONT COLOR="#008080">Remove</FONT>
                                             <FONT COLOR="#008080">RECORD</FONT> <FONT COLOR="#008000">FileName-CODIGO</FONT>
                                             <FONT COLOR="#008080">FILE</FONT> &quot;<FONT COLOR="#ff0000">fotos</FONT>&quot;
                                   END-EXEC
                              END-IF
                         END-IF
                    END-IF
               WHEN (<FONT COLOR="#ff00ff">ALTERACAO</FONT> OR <FONT COLOR="#ff00ff">EXCLUSAO</FONT> OR <FONT COLOR="#ff00ff">CONSULTA</FONT>)
                AND (<FONT COLOR="#008080">PAGE-DOWN</FONT> OR <FONT COLOR="#008080">PAGE-UP</FONT>)
                    IF   <FONT COLOR="#008000">FS-FileName</FONT> = &quot;<FONT COLOR="#ff0000">23</FONT>&quot;
                         EVALUATE <FONT COLOR="#008000">CHAVE</FONT>
                             WHEN <FONT COLOR="#ff0000">1</FONT>
                                  START <FONT COLOR="#008000">FileName</FONT>
                                        KEY NOT &lt; <FONT COLOR="#008000">FileName-CHAVE</FONT>
                                        INVALID KEY
                                          START <FONT COLOR="#008000">FileName</FONT>
                                            KEY NOT &gt; <FONT COLOR="#008000">FileName-CHAVE</FONT>
                                        END-START
                                  END-START
                             WHEN <FONT COLOR="#ff0000">2</FONT>
                                  START <FONT COLOR="#008000">FileName</FONT>
                                        KEY NOT &lt; <FONT COLOR="#008000">FileName-DESCRICAO</FONT>
                                        INVALID KEY
                                          START <FONT COLOR="#008000">FileName</FONT>
                                            KEY NOT &gt; <FONT COLOR="#008000">FileName-DESCRICAO</FONT>
                                        END-START
                                  END-START
                         END-EVALUATE
                    END-IF
                    EVALUATE TRUE
                             WHEN <FONT COLOR="#008080">PAGE-DOWN</FONT>
<FONT COLOR="#000000">                              AND </FONT><FONT COLOR="#ff00ff">PAGE-DOWN-ON</FONT>
                                  READ <FONT COLOR="#008000">FileName</FONT>
                                       NEXT RECORD IGNORE LOCK
                             WHEN <FONT COLOR="#008080">PAGE-UP</FONT>
<FONT COLOR="#000000">                              AND </FONT><FONT COLOR="#ff00ff">PAGE-UP-ON</FONT>
                                  READ <FONT COLOR="#008000">FileName</FONT>
                                       PREVIOUS RECORD IGNORE LOCK
                    END-EVALUATE
                    IF   <FONT COLOR="#008000">FS-FileName</FONT> &gt; &quot;<FONT COLOR="#ff0000">09</FONT>&quot;
                         IF   <FONT COLOR="#008000">FS-FileName</FONT> &gt; &quot;10&quot;
                              MOVE &quot;<FONT COLOR="#ff0000">V</FONT>&quot; TO <FONT COLOR="#008000">FUNCAO</FONT>
                         END-IF
                    ELSE
                         EVALUATE TRUE
                                  WHEN <FONT COLOR="#008080">PAGE-DOWN</FONT>
                                   AND <FONT COLOR="#ff00ff">PAGE-UP-OFF</FONT>
                                       SET <FONT COLOR="#ff00ff">PAGE-UP-ON</FONT>   TO TRUE
                                  WHEN <FONT COLOR="#008080">PAGE-UP</FONT>
                                   AND <FONT COLOR="#ff00ff">PAGE-DOWN-OFF</FONT>
                                       SET <FONT COLOR="#ff00ff">PAGE-DOWN-ON</FONT> TO TRUE
                         END-EVALUATE
                         SET READY-ON TO TRUE
                         PERFORM <FONT COLOR="#008000">111-EXIBE</FONT> THRU <FONT COLOR="#008000">111-99-FIM</FONT>
                    END-IF
                    IF   <FONT COLOR="#008000">FS-FileName</FONT> = &quot;<FONT COLOR="#ff0000">10</FONT>&quot;
                         SET <FONT COLOR="#ff00ff">READY-OFF</FONT> TO TRUE
                         EVALUATE TRUE
                                  WHEN <FONT COLOR="#008080">PAGE-DOWN</FONT>
                                       SET <FONT COLOR="#ff00ff">PAGE-DOWN-OFF</FONT> TO TRUE
                                       READ <FONT COLOR="#008000">FileName</FONT>
                                       PREVIOUS RECORD IGNORE LOCK
                                  WHEN <FONT COLOR="#008080">PAGE-UP</FONT>
                                       SET <FONT COLOR="#ff00ff">PAGE-UP-OFF</FONT>   TO TRUE
                                       READ <FONT COLOR="#008000">FileName</FONT>
                                       NEXT RECORD IGNORE LOCK
                         END-EVALUATE
                         IF  (<FONT COLOR="#008000">FS-FileName</FONT> NOT = &quot;<FONT COLOR="#ff0000">10</FONT>&quot;)
                         AND (<FONT COLOR="#008000">FS-FileName</FONT> NOT = &quot;<FONT COLOR="#ff0000">46</FONT>&quot;)<BR>                              SET  <FONT COLOR="#ff00ff">READY-ON</FONT> TO TRUE
                              MOVE &quot;<FONT COLOR="#ff0000">10</FONT>&quot;     TO <FONT COLOR="#008000">FS-FileName</FONT>
                         END-IF
                    END-IF
               WHEN (<FONT COLOR="#ff00ff">ALTERACAO</FONT> OR <FONT COLOR="#ff00ff">EXCLUSAO</FONT> OR <FONT COLOR="#ff00ff">CONSULTA</FONT>)
                AND (<FONT COLOR="#008080">ENTER-KEY</FONT> OR <FONT COLOR="#008080">F2</FONT>)
                    IF   <FONT COLOR="#ff00ff">CONSULTA</FONT>
                         READ <FONT COLOR="#008000">FileName</FONT> IGNORE LOCK
                    ELSE
                         READ <FONT COLOR="#008000">FileName</FONT> WITH LOCK
                         IF   <FONT COLOR="#008000">FS-FileName</FONT> = &quot;<FONT COLOR="#ff0000">9D</FONT>&quot;
                              READ <FONT COLOR="#008000">FileName</FONT> IGNORE LOCK
                              MOVE &quot;<FONT COLOR="#ff0000">9D</FONT>&quot; TO <FONT COLOR="#008000">FS-FileName</FONT>
                         END-IF
                    END-IF
                    MOVE <FONT COLOR="#ff0000">1</FONT>      TO <FONT COLOR="#008000">POSICIONA</FONT>
                    MOVE SPACES TO <FONT COLOR="#008000">SALVA-REG</FONT>
                    PERFORM <FONT COLOR="#008000">111-EXIBE</FONT> THRU <FONT COLOR="#008000">111-99-FIM</FONT>
                    EVALUATE TRUE
                        WHEN <FONT COLOR="#008000">FS-FileName</FONT> = &quot;<FONT COLOR="#ff0000">23</FONT>&quot;<BR>                             SET <FONT COLOR="#ff00ff">READY-OFF</FONT> TO TRUE
                             EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="send.html"><FONT COLOR="#008080">Send</FONT></A>
                                  <FONT COLOR="#008080">Message</FONT> &quot;<FONT COLOR="#ff0000">Produto n&atilde;o cadastrado</FONT>&quot;
                             END-EXEC
                        WHEN <FONT COLOR="#008000"><FONT COLOR="#008000">FS-FileName</FONT></FONT> = &quot;<FONT COLOR="#ff0000"><FONT COLOR="#ff0000">9D</FONT></FONT>&quot;
                             SET <FONT COLOR="#ff00ff">READY-OFF</FONT> TO TRUE<BR>                             EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="send.html"><FONT COLOR="#008080">Send</FONT></A>
                                  <FONT COLOR="#008080">Message</FONT> &quot;<FONT COLOR="#ff0000">Produto ocupado</FONT>&quot;
                             END-EXEC
                        WHEN <FONT COLOR="#008000">FS-FileName</FONT> &gt; &quot;<FONT COLOR="#ff0000">09</FONT>&quot;
                             MOVE &quot;<FONT COLOR="#ff0000">V</FONT>&quot; TO <FONT COLOR="#008000">FUNCAO</FONT>
                        WHEN <FONT COLOR="#ff00ff">ALTERACAO</FONT>
                             MOVE <FONT COLOR="#008000">FileName-REG</FONT> TO <FONT COLOR="#008000">SALVA-REG</FONT>
                             EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> <FONT COLOR="#008080">DROP</FONT> END-EXEC
                             PERFORM <FONT COLOR="#008000">120-CRITICA</FONT> THRU <FONT COLOR="#008000">120-99-FIM</FONT>
                             IF   <FONT COLOR="#ff00ff">EFETIVAR</FONT>
                                  REWRITE <FONT COLOR="#008000">FileName-REG</FONT>
                             ELSE
                                  UNLOCK <FONT COLOR="#008000">FileName</FONT>
                             END-IF
                        WHEN <FONT COLOR="#ff00ff">EXCLUSAO</FONT>
                             PERFORM <FONT COLOR="#008000">130-CONFIRMA</FONT> THRU <FONT COLOR="#008000">130-99-FIM</FONT>
                             IF   <FONT COLOR="#ff00ff">EFETIVAR</FONT>
                                  DELETE <FONT COLOR="#008000">FileName</FONT> RECORD
                             ELSE
                                  UNLOCK <FONT COLOR="#008000">FileName</FONT>
                             END-IF
                             EXEC<FONT COLOR="#008080"> COBOLware</FONT> <A HREF="pict.html"><FONT COLOR="#008080">Picture</FONT></A> <FONT COLOR="#008080">Erase</FONT>
                          <FONT COLOR="#008080">             LINE</FONT> <FONT COLOR="#ff0000">9</FONT> <FONT COLOR="#008080">COLUMN</FONT> <FONT COLOR="#ff0000">52</FONT>
                             END-EXEC
                             EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="pict.html"><FONT COLOR="#008080">Picture</FONT></A> <FONT COLOR="#008080">Remove</FONT>
                                     <FONT COLOR="#008080">RECORD</FONT> <FONT COLOR="#008000">FileName-CODIGO</FONT>
                                       <FONT COLOR="#008080">FILE</FONT> &quot;<FONT COLOR="#ff0000">fotos</FONT>&quot;
                             END-EXEC
                    END-EVALUATE
                    IF   <FONT COLOR="#008000">FS-FileName</FONT> &gt; &quot;<FONT COLOR="#ff0000">09</FONT>&quot;
                    AND  <FONT COLOR="#ff00ff">EFETIVAR</FONT>
                         MOVE &quot;<FONT COLOR="#ff0000">V</FONT>&quot; TO <FONT COLOR="#008000">FUNCAO</FONT>
                    END-IF
           END-EVALUATE.
<BR>       <FONT COLOR="#008000">100-99-FIM</FONT>. EXIT.

       <FONT COLOR="#008000">110-GRUPO</FONT>.

           EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> <FONT COLOR="#008080">DROP</FONT> END-EXEC
           EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> <FONT COLOR="#008080">GROUP</FONT>
                <FONT COLOR="#008080">LINE</FONT> <FONT COLOR="#ff0000">14</FONT> <FONT COLOR="#008080">COLUMN</FONT> <FONT COLOR="#ff0000">3</FONT> <FONT COLOR="#008080">WIDTH</FONT> <FONT COLOR="#ff0000">36</FONT> <FONT COLOR="#008080">CAPTION</FONT> &quot;<FONT COLOR="#ff0000">Tipo</FONT>&quot;
           END-EXEC
           EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> GROUP
                <FONT COLOR="#008080">LINE</FONT> <FONT COLOR="#ff0000">18</FONT> <FONT COLOR="#008080">COLUMN</FONT> <FONT COLOR="#ff0000">3</FONT> <FONT COLOR="#008080">WIDTH</FONT> <FONT COLOR="#ff0000">41</FONT> <FONT COLOR="#008080">CAPTION</FONT> &quot;<FONT COLOR="#ff0000">Op&ccedil;&otilde;es</FONT>&quot;
           END-EXEC.

       <FONT COLOR="#008000">110-99-FIM</FONT>. EXIT.

       <FONT COLOR="#008000">111-EXIBE</FONT>.

           INITIALIZE <FONT COLOR="#008000">TIPOS<BR></FONT>
           IF   <FONT COLOR="#008000">FileName-TIPO</FONT> &gt; 0
                MOVE &quot;<FONT COLOR="#ff0000">1</FONT>&quot; TO <FONT COLOR="#008000">CWRADIO</FONT>(<FONT COLOR="#008000">FileName-TIPO</FONT>)
           END-IF<BR>
           MOVE <FONT COLOR="#008000">FileName-OPCOES</FONT> TO <FONT COLOR="#008000">OPCOES</FONT>
           EXEC <FONT COLOR="#008080">COBOLware <A HREF="pict.html">Picture</A> Display</FONT>
<FONT COLOR="#008080">                     LINE </FONT><FONT COLOR="#ff0000">9</FONT><FONT COLOR="#008080"> COLUMN </FONT><FONT COLOR="#ff0000">52</FONT><FONT COLOR="#008080"> WIDTH  </FONT><FONT COLOR="#ff0000">21</FONT>
<FONT COLOR="#008080">                                      HEIGHT </FONT><FONT COLOR="#ff0000">13</FONT>
<FONT COLOR="#008080">                     RECORD </FONT><FONT COLOR="#008000">FileName-CODIGO</FONT>
<FONT COLOR="#008080">                     FILE </FONT>&quot;<FONT COLOR="#ff0000">fotos</FONT>&quot;
           END-EXEC
           DISPLAY <A HREF="ctac.html"><FONT COLOR="#008080">CTAC</FONT></A><FONT COLOR="#008000">-VAR-CWCADS</FONT>.

       1<FONT COLOR="#008000">11-99-FIM</FONT>. EXIT.

       <FONT COLOR="#008000">120-CRITICA</FONT>.

           PERFORM <FONT COLOR="#008000">110-GRUPO</FONT> THRU <FONT COLOR="#008000">110-99-FIM</FONT>
           COPY <A HREF="CWESCP.CPY"><FONT COLOR="#008080"><FONT COLOR="#008080">CWESCP</FONT></FONT></A>.
           EXEC <FONT COLOR="#008080"><FONT COLOR="#008080">COBOLware</FONT></FONT> <A HREF="obje.html"><FONT COLOR="#008080"><FONT COLOR="#008080">Object</FONT></FONT></A> <FONT COLOR="#008080"><FONT COLOR="#008080">Push-Button Small</FONT></FONT>
<FONT COLOR="#008080">                     LINE </FONT><FONT COLOR="#ff0000">23</FONT><FONT COLOR="#008080"> COLUMN </FONT><FONT COLOR="#ff0000">02</FONT><FONT COLOR="#008080"> WIDTH </FONT><FONT COLOR="#ff0000">13</FONT>
<FONT COLOR="#008080">                     CAPTION &quot; </FONT><FONT COLOR="#ff0000">f3-~Concluir</FONT><FONT COLOR="#008080"> &quot;</FONT>
<FONT COLOR="#008080">                     KEY F3 TAB-OFF</FONT>
           END-EXEC
           EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> <FONT COLOR="#008080">Push-Button Small</FONT>
<FONT COLOR="#008080">                     LINE </FONT><FONT COLOR="#ff0000">23</FONT><FONT COLOR="#008080"> COLUMN </FONT><FONT COLOR="#ff0000">17</FONT><FONT COLOR="#008080"> WIDTH </FONT><FONT COLOR="#ff0000">9</FONT>
<FONT COLOR="#008080">                     CAPTION &quot; </FONT><FONT COLOR="#ff0000">f4-~Foto</FONT><FONT COLOR="#008080"> &quot;</FONT>
<FONT COLOR="#008080">                     KEY F4 TAB-OFF</FONT>
           END-EXEC
           EXEC COBOLware <A HREF="obje.html"><FONT COLOR="#008080">Object</FONT></A> Validate
                  <FONT COLOR="#008080">PROGRAM</FONT> &quot;<A HREF="cwcad2.html">CWCAD2</A>&quot; <FONT COLOR="#008080">USING </FONT><FONT COLOR="#008000">FileName-DESCRICAO</FONT>
<FONT COLOR="#008080">                                         </FONT><FONT COLOR="#008000">FileName-PRECO</FONT>
<FONT COLOR="#008080">                                         CWRADIO(</FONT><FONT COLOR="#ff0000">1</FONT><FONT COLOR="#008080">)</FONT>
<FONT COLOR="#008080">                                         CWRADIO(</FONT><FONT COLOR="#ff0000">2</FONT><FONT COLOR="#008080">)</FONT>
<FONT COLOR="#008080">                                         CWRADIO(</FONT><FONT COLOR="#ff0000">3</FONT><FONT COLOR="#008080">)</FONT>
<FONT COLOR="#008080">                                         CWCHECK(</FONT><FONT COLOR="#ff0000">1</FONT><FONT COLOR="#008080">)</FONT>
<FONT COLOR="#008080">                                         CWCHECK(</FONT><FONT COLOR="#ff0000">2</FONT><FONT COLOR="#008080">)</FONT>
<FONT COLOR="#008080">                                         CWCHECK(</FONT><FONT COLOR="#ff0000">3</FONT><FONT COLOR="#008080">)</FONT>
<FONT COLOR="#008080">                    FIELD ANY</FONT>
           END-EXEC

           PERFORM TEST AFTER UNTIL NOT <FONT COLOR="#008080">F4</FONT>
                   ACCEPT <FONT COLOR="#008000">TELA-DADOS</FONT>
                   ACCEPT <FONT COLOR="#008000">TECLA</FONT> FROM ESCAPE KEY
                   IF  <FONT COLOR="#008080">F4</FONT>
                       EXEC <FONT COLOR="#008080">COBOLware <A HREF="pict.html">Picture</A> Update</FONT>
<FONT COLOR="#008080">                                 RECORD </FONT><FONT COLOR="#008000">FileName-CODIGO</FONT>
<FONT COLOR="#008080">                                 FILE </FONT>&quot;<FONT COLOR="#ff0000">fotos</FONT>&quot;
                       END-EXEC
                       EXEC <FONT COLOR="#008080">COBOLware <A HREF="pict.html">Picture</A> Display</FONT>
<FONT COLOR="#008080">                                 LINE </FONT><FONT COLOR="#ff0000">9</FONT><FONT COLOR="#008080"> COLUMN </FONT><FONT COLOR="#ff0000">52</FONT><FONT COLOR="#008080"> WIDTH  </FONT><FONT COLOR="#ff0000">21</FONT>
<FONT COLOR="#008080">                                                  HEIGHT </FONT><FONT COLOR="#ff0000">13</FONT>
<FONT COLOR="#008080">                               RECORD </FONT><FONT COLOR="#008000">FileName-CODIGO</FONT>
<FONT COLOR="#008080">                                 FILE </FONT>&quot;<FONT COLOR="#ff0000">fotos</FONT>&quot;
                       END-EXEC
                   END-IF
           END-PERFORM<BR>
           MOVE SPACE TO <FONT COLOR="#008000">COMANDO<BR></FONT>
           IF   NOT <FONT COLOR="#008080">ESC</FONT>
                PERFORM VARYING <FONT COLOR="#008000">FileName-TIPO</FONT> FROM <FONT COLOR="#008000">3</FONT> BY <FONT COLOR="#ff0000">-1</FONT>
                                UNTIL <FONT COLOR="#008000">FileName-TIPO</FONT> = 0
                                   OR <FONT COLOR="#008080">CWRADIO</FONT> (<FONT COLOR="#008000">FileName-TIPO</FONT>) = &quot;<FONT COLOR="#ff0000">1</FONT>&quot;
                         CONTINUE
                END-PERFORM
                MOVE <FONT COLOR="#008000">OPCOES</FONT> TO <FONT COLOR="#008000">FileName-OPCOES</FONT>
                IF    <FONT COLOR="#008000">FileName-REG</FONT> = <FONT COLOR="#008000">SALVA-REG</FONT>
                AND   <FONT COLOR="#ff00ff">ALTERACAO</FONT>
                      SET <FONT COLOR="#ff00ff">ABORTAR</FONT> TO TRUE
                ELSE
                      PERFORM <FONT COLOR="#008000">130-CONFIRMA</FONT> THRU <FONT COLOR="#008000">130-99-FIM</FONT>
                END-IF
           ELSE
                MOVE SPACE TO <FONT COLOR="#008000">FUNCAO</FONT>
           END-IF

           PERFORM <FONT COLOR="#008000">110-GRUPO</FONT> THRU <FONT COLOR="#008000">110-99-FIM</FONT>.

       12<FONT COLOR="#008000">0-99-FIM</FONT>. EXIT.

       <FONT COLOR="#008000">130-CONFIRMA</FONT>.

           COPY <A HREF="CWEFAB.CPY"><FONT COLOR="#008080">CWEFAB</FONT></A>.
           IF   <FONT COLOR="#ff00ff">EFETIVAR</FONT>
                EXEC <FONT COLOR="#008080">COBOLware</FONT><FONT COLOR="#008000"> </FONT><A HREF="logw.html"><FONT COLOR="#008080">LogWrite</FONT></A>
<FONT COLOR="#008000">                     </FONT><FONT COLOR="#008080">FUNCTION</FONT><FONT COLOR="#008000"> FUNCAO</FONT>
<FONT COLOR="#008000">                     </FONT><FONT COLOR="#008080">TEXT</FONT><FONT COLOR="#008000"> FileName-CODIGO</FONT>
                END-EXEC
           END-IF.

       <FONT COLOR="#008000">130-99-FIM</FONT>. EXIT.

       <FONT COLOR="#008000">140-NOVA-CHAVE</FONT>.

           MOVE ALL <FONT COLOR="#ff0000">X&quot;FF&quot;</FONT> TO <FONT COLOR="#008000">FileName-REG</FONT>
           START <FONT COLOR="#008000">FileName</FONT> KEY NOT &gt; <FONT COLOR="#008000">FileName-CHAVE</FONT>
            INVALID KEY
                    INITIALIZE <FONT COLOR="#008000">FileName-REG</FONT>
                    MOVE <FONT COLOR="#ff0000">1</FONT> TO <FONT COLOR="#008000">FileName-CODIGO</FONT>
               NOT INVALID KEY
                   READ <FONT COLOR="#008000">FileName</FONT> PREVIOUS RECORD IGNORE LOCK
                   ADD  <FONT COLOR="#ff0000">1</FONT>              TO <FONT COLOR="#008000">FileName-CODIGO</FONT>
                   MOVE <FONT COLOR="#008000">FileName-CHAVE</FONT> TO <FONT COLOR="#008000">SALVA-CHAVE</FONT>
                   INITIALIZE <FONT COLOR="#008000">FileName-REG</FONT>
                   MOVE <FONT COLOR="#008000">SALVA-CHAVE</FONT>    TO <FONT COLOR="#008000">FileName-CHAVE</FONT>
           END-START
           PERFORM <FONT COLOR="#008000">111-EXIBE</FONT> THRU <FONT COLOR="#008000">111-99-FIM</FONT>
           DISPLAY <FONT COLOR="#008000">TELA-CHAVE</FONT>.<BR>
       <FONT COLOR="#008000">140-99-FIM</FONT>. EXIT.

       END PROGRAM <FONT COLOR="#ff0000">CWCADS</FONT>.</PRE>
</BODY>
</HTML>
