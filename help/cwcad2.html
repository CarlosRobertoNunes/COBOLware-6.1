<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
        <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
        <TITLE>COBOLware 6.1 - Exemplo de m&oacute;dulo validador</TITLE>
        <META NAME="GENERATOR" CONTENT="BrOffice.org 3.1  (Win32)">
        <META NAME="CREATED" CONTENT="20070715;23083700">
        <META NAME="CHANGEDBY" CONTENT="Carlos Roberto Souza Nunes">
        <META NAME="CHANGED" CONTENT="20090615;9513000">
        <STYLE TYPE="text/css">
        <!--
                P { color: #000000; font-family: "Courier New" }
                PRE { color: #000000 }
        -->
        </STYLE>
</HEAD>
<BODY LANG="pt-BR" TEXT="#000000" DIR="LTR">
<PRE>       IDENTIFICATION DIVISION.
       PROGRAM-ID.    <FONT COLOR="#ff0000">CWCAD2</FONT>.
       AUTHOR.        COBOLware Services Ltda.
       DATE-WRITTEN.  <FONT COLOR="#ff0000">99/99/9999</FONT>.
       SECURITY.      <FONT COLOR="#ff0000">*************************************************</FONT>
<FONT COLOR="#ff0000">                      *                                               *</FONT>
<FONT COLOR="#ff0000">                      *  Exemplo de modulo validador                  *</FONT>
<FONT COLOR="#ff0000">                      *                                               *</FONT>
<FONT COLOR="#ff0000">                      *************************************************</FONT>
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.

       DATA DIVISION.
       FILE SECTION.

       WORKING-STORAGE SECTION.

       77  <FONT COLOR="#008000">TECLA</FONT>                      PIC  9(002). COPY <A HREF="CWKEYS.CPY"><FONT COLOR="#008080">CWKEYS</FONT></A>.

       LINKAGE SECTION.

       01  <FONT COLOR="#008000">ERRO</FONT>                       PIC  9(001).

       01  <FONT COLOR="#008000">DADOS</FONT>                      PIC X(2000).
       01  <FONT COLOR="#008000">TELA-CHAVE</FONT> REDEFINES <FONT COLOR="#008000">DADOS</FONT>.
           05 FileName-CODIGO         PIC  9(005).
       01  <FONT COLOR="#008000">TELA-DADOS</FONT> REDEFINES <FONT COLOR="#008000">DADOS</FONT>.
           05 <FONT COLOR="#008000">FileName-DESCRICAO</FONT>      PIC  X(030).
           05 <FONT COLOR="#008000">FileName-PRECO</FONT>          PIC  9(008)V99.
           05 <FONT COLOR="#008000">CWRADIO </FONT>OCCURS 3        PIC  X(001).
           05 <FONT COLOR="#008000">CWCHECK </FONT>OCCURS 3        PIC  X(001).

       01  <FONT COLOR="#008000">FIELD</FONT>                      PIC  X(030).
       01  <FONT COLOR="#008000">SUBSCRIPT </FONT>                 PIC  9(003).

       PROCEDURE DIVISION USING <FONT COLOR="#008000">ERRO DADOS FIELD SUBSCRIPT</FONT>.

       <FONT COLOR="#008000">000-INICIO</FONT>.

           MOVE 0 TO <FONT COLOR="#008000">ERRO</FONT>
<FONT COLOR="#008000">           <FONT COLOR="#000000">ACCEPT</FONT> TECLA <FONT COLOR="#000000">FROM ESCAPE KEY</FONT></FONT>

           EVALUATE <FONT COLOR="#008000">FIELD</FONT>
               WHEN &quot;<A HREF="cwcads.html#FileName-DESCRICAO"><FONT COLOR="#ff0000">FILENAME-DESCRICAO</FONT></A>&quot;
                    IF   <FONT COLOR="#008000">FileName-DESCRICAO</FONT> = SPACES
                         EXEC <FONT COLOR="#008080">COBOLware <A HREF="send.html">Send</A></FONT>
<FONT COLOR="#008080">                              Message</FONT> &quot;<FONT COLOR="#ff0000">Falta descri&ccedil;&atilde;o</FONT>&quot;
                         END-EXEC
                         MOVE <FONT COLOR="#ff0000">1</FONT> TO <FONT COLOR="#008000">ERRO</FONT>
                    END-IF
               WHEN &quot;<A HREF="cwcads.html#FileName-PRECO"><FONT COLOR="#ff0000">FILENAME-PRECO</FONT></A>&quot;
                    IF   FileName-PRECO = 0
                         EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="send.html"><FONT COLOR="#008080">Send</FONT></A>
                              <FONT COLOR="#008080">Message</FONT> &quot;<FONT COLOR="#ff0000">Falta pre&ccedil;o</FONT>&quot;
                         END-EXEC
                         MOVE <FONT COLOR="#ff0000">1</FONT> TO <FONT COLOR="#008000">ERRO</FONT>
                    END-IF
               WHEN &quot;<A HREF="cwcads.html#CWRADIO"><FONT COLOR="#ff0000">CWRADIO</FONT></A>&quot;
                    IF   <FONT COLOR="#008000">SUBSCRIPT</FONT> = 3
                    AND (<FONT COLOR="#008000">CWRADIO</FONT> (<FONT COLOR="#ff0000">1</FONT>) NOT = '<FONT COLOR="#ff0000">1</FONT>')
                    AND (<FONT COLOR="#008000">CWRADIO</FONT> (<FONT COLOR="#ff0000">2</FONT>) NOT = '<FONT COLOR="#ff0000">1</FONT>')
                    AND (<FONT COLOR="#008000">CWRADIO</FONT> (<FONT COLOR="#ff0000">3</FONT>) NOT = '<FONT COLOR="#ff0000">1</FONT>')
                         EXEC <FONT COLOR="#008080">COBOLware</FONT> <A HREF="send.html"><FONT COLOR="#008080">Send</FONT></A>
                              <FONT COLOR="#008080">Message</FONT> &quot;<FONT COLOR="#ff0000">Falta tipo</FONT>&quot;
                         END-EXEC
                         MOVE <FONT COLOR="#ff0000">1</FONT> TO <FONT COLOR="#008000">ERRO</FONT>
                    END-IF
           END-EVALUATE.

       <FONT COLOR="#008000">000-99-FIM</FONT>. GOBACK.

       END PROGRAM <FONT COLOR="#ff0000">CWCAD2</FONT>.</PRE>
</BODY>
</HTML>
