<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
        <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
        <TITLE>COBOLware 6.1 - Exemplo de tratamento de padr&atilde;o de tela alternativo</TITLE>
        <META NAME="GENERATOR" CONTENT="BrOffice.org 3.1  (Win32)">
        <META NAME="CREATED" CONTENT="20070715;23051700">
        <META NAME="CHANGEDBY" CONTENT="Carlos Roberto de Souza Nunes">
        <META NAME="CHANGED" CONTENT="20120713;8282300">
        <STYLE TYPE="text/css">
        <!--
                P { color: #000000; font-family: "Courier New" }
                PRE { color: #000000 }
        -->
        </STYLE>
</HEAD>
<BODY LANG="pt-BR" TEXT="#000000" DIR="LTR">
<PRE>       IDENTIFICATION DIVISION.
       PROGRAM-ID.    <FONT COLOR="#ff0000">FRAME</FONT>.
       AUTHOR.        COBOLware Services Ltda.
       DATE-WRITTEN.  <FONT COLOR="#ff0000">10/06/2005</FONT>.
       SECURITY.      <FONT COLOR="#ff0000">*************************************************</FONT>
                      <FONT COLOR="#ff0000">*                                               *</FONT>
                      <FONT COLOR="#ff0000">* Exemplo de tratamento de padr&atilde;o de tela.      *</FONT>
                      <FONT COLOR="#ff0000">*                                               *</FONT>
                      <FONT COLOR="#ff0000">*************************************************</FONT>
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.

       DATA DIVISION.
       FILE SECTION.

       WORKING-STORAGE SECTION.

       77  <FONT COLOR="#008000">I</FONT>        PIC 99    VALUE 0.
       77  <FONT COLOR="#008000">C</FONT>        PIC 99    VALUE 0.
       77  <FONT COLOR="#008000">empresa</FONT>  PIC X(30) VALUE SPACES.
       77  <FONT COLOR="#008000">sistema</FONT>  PIC X(30) VALUE SPACES.
       77  <FONT COLOR="#008000">programa</FONT> PIC X(08) VALUE SPACES.
       77  <FONT COLOR="#008000">usuario</FONT>  PIC X(30) VALUE SPACES.
       77  <FONT COLOR="#008000">tracos</FONT>   PIC X(80) VALUE ALL X'C4'.
       77  <FONT COLOR="#008000">espacos</FONT>  PIC X(80) VALUE SPACES.
       77  <FONT COLOR="#008000">curdir</FONT>   PIC X(50) VALUE SPACES.

       LINKAGE SECTION.

       01  <FONT COLOR="#008000">OPTION</FONT> PIC X.
       01  <FONT COLOR="#008000">PARAMETRO</FONT> PIC X(80).
       01  REDEFINES <FONT COLOR="#008000">PARAMETRO</FONT>.
           05 <FONT COLOR="#008000">DESCRICAO-OPCAO</FONT> PIC X(34).
       01  REDEFINES <FONT COLOR="#008000">PARAMETRO</FONT>.
           05 <FONT COLOR="#008000">RODAPE</FONT>          PIC X(68).
       01  REDEFINES <FONT COLOR="#008000">PARAMETRO</FONT>.
           05 <FONT COLOR="#008000">OBS</FONT>             PIC X(29).
       01  <FONT COLOR="#008000">PARAMETRO2</FONT> PIC X(80).

       PROCEDURE DIVISION USING <FONT COLOR="#008000">OPTION</FONT> <FONT COLOR="#008000">PARAMETRO</FONT> <FONT COLOR="#008000">PARAMETRO2</FONT>.

       <FONT COLOR="#008000">000-INICIO</FONT>.

           EVALUATE <FONT COLOR="#008000">OPTION</FONT>
               WHEN 'f' <FONT COLOR="#ff00ff">*&gt; Exibe observa&ccedil;&atilde;o de fun&ccedil;&atilde;o de cadastro</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">4</FONT>, <FONT COLOR="#ff0000">1</FONT>) OBS
               WHEN 'F' <FONT COLOR="#ff00ff">*&gt; Exibe tela padr&atilde;o e moldura</FONT>
                    EXEC <FONT COLOR="#008080">COBOLware <A HREF="gets.html">GetSystem</A></FONT>
                     <FONT COLOR="#008080">SCREEN-APLICATION</FONT>;<FONT COLOR="#008000">sistema</FONT>
                     <FONT COLOR="#008080">SCREEN-COMPANY</FONT>;<FONT COLOR="#008000">empresa</FONT>
                     <FONT COLOR="#008080">PROGRAM</FONT>;<FONT COLOR="#008000">programa</FONT>
                     <FONT COLOR="#008080">USER</FONT>;<FONT COLOR="#008000">usuario</FONT>
                    END-EXEC
                    DISPLAY (<FONT COLOR="#ff0000">1</FONT>, <FONT COLOR="#ff0000">1</FONT>) ERASE
                    DISPLAY (<FONT COLOR="#ff0000">1</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">empresa</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">2</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">sistema</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">3</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">tracos</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">23</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">tracos</FONT>
                    EXEC <FONT COLOR="#008080">COBOLware <A HREF="pack.html">Pack String</A></FONT> <FONT COLOR="#008000">usuario</FONT> <FONT COLOR="#008080">WIDTH</FONT> <FONT COLOR="#008000">I</FONT> END-EXEC
                    COMPUTE <FONT COLOR="#008000">C</FONT> = <FONT COLOR="#ff0000">80</FONT> - <FONT COLOR="#008000">I</FONT> + <FONT COLOR="#ff0000">1</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">1</FONT>, <FONT COLOR="#008000">C</FONT>) <FONT COLOR="#008000">usuario</FONT> WITH SIZE <FONT COLOR="#008000">I</FONT>
                    EXEC <FONT COLOR="#008080">COBOLware <A HREF="pack.html">Pack String</A></FONT> <FONT COLOR="#008000"><FONT COLOR="#008000">programa</FONT></FONT> <FONT COLOR="#008080">WIDTH</FONT> <FONT COLOR="#008000"><FONT COLOR="#008000">I</FONT></FONT> END-EXEC
                    COMPUTE <FONT COLOR="#008000">C</FONT> = <FONT COLOR="#ff0000">80</FONT> - <FONT COLOR="#008000">I</FONT> + 1
                    DISPLAY (<FONT COLOR="#ff0000">2</FONT>, <FONT COLOR="#008000">C</FONT>) <FONT COLOR="#008000">programa</FONT> WITH SIZE <FONT COLOR="#008000">I</FONT>
               WHEN 'E' <FONT COLOR="#ff00ff">*&gt; Limpa &aacute;rea de trabalho da tela</FONT>
                    PERFORM VARYING <FONT COLOR="#008000">I</FONT> FROM <FONT COLOR="#ff0000">4</FONT> BY <FONT COLOR="#ff0000">1</FONT>
                            UNTIL <FONT COLOR="#008000">I</FONT> &gt; <FONT COLOR="#ff0000">25</FONT>
                            IF <FONT COLOR="#008000">I</FONT> &lt;&gt; <FONT COLOR="#ff0000">23</FONT>
                               DISPLAY (<FONT COLOR="#008000">I</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">ESPACOS</FONT>
                            END-IF
                    END-PERFORM
               WHEN 'O' <FONT COLOR="#ff00ff">*&gt; Exibe Titulo da op&ccedil;&atilde;o de menu selecionada</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">2</FONT>, <FONT COLOR="#ff0000">33</FONT>) <FONT COLOR="#008000">DESCRICAO-OPCAO</FONT>
               WHEN 'M' <FONT COLOR="#ff00ff">*&gt; Apaga linha de mensagem</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">24</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">ESPACOS</FONT>
               WHEN 'P' <FONT COLOR="#ff00ff">*&gt; Nome do programa</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">25</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">ESPACOS</FONT> WITH SIZE <FONT COLOR="#ff0000">79</FONT>
                    MOVE SPACES TO <FONT COLOR="#008000">programa</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">2</FONT>, <FONT COLOR="#ff0000">73</FONT>) <FONT COLOR="#008000">programa</FONT>
                    MOVE <FONT COLOR="#008000">PARAMETRO</FONT> (<FONT COLOR="#ff0000">1</FONT>:<FONT COLOR="#ff0000">8</FONT>) TO <FONT COLOR="#008000">PROGRAMA</FONT>
                    EXEC <FONT COLOR="#008080">COBOLware <A HREF="pack.html">Pack String</A></FONT> <FONT COLOR="#008000">programa</FONT> <FONT COLOR="#008080">WIDTH</FONT> <FONT COLOR="#008000">I</FONT> END-EXEC
                    COMPUTE <FONT COLOR="#008000">C</FONT> = <FONT COLOR="#ff0000">80</FONT> - <FONT COLOR="#008000">I</FONT> + <FONT COLOR="#ff0000">1</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">2</FONT>, <FONT COLOR="#008000">C</FONT>) <FONT COLOR="#008000">programa</FONT> WITH SIZE <FONT COLOR="#008000">I</FONT>
               WHEN 'I' <FONT COLOR="#ff00ff">*&gt; Atualiza empresa e sistema</FONT>
                    MOVE <FONT COLOR="#008000">PARAMETRO</FONT>(<FONT COLOR="#ff0000">1</FONT>:<FONT COLOR="#ff0000">30</FONT>) TO <FONT COLOR="#008000">empresa</FONT>
                    MOVE <FONT COLOR="#008000"><FONT COLOR="#008000">parametro2</FONT></FONT>(<FONT COLOR="#ff0000"><FONT COLOR="#ff0000">1</FONT></FONT>:<FONT COLOR="#ff0000">30</FONT>) TO <FONT COLOR="#008000"><FONT COLOR="#008000">sistema</FONT></FONT>
                    DISPLAY (<FONT COLOR="#ff0000">1</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">empresa</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">2</FONT>, <FONT COLOR="#ff0000">1</FONT>) <FONT COLOR="#008000">sistema</FONT>
               WHEN 'N' <FONT COLOR="#ff00ff">*&gt; Atualiza usu&aacute;rio e pasta corrente</FONT>
                    MOVE SPACES TO <FONT COLOR="#008000">usuario</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">1</FONT>, <FONT COLOR="#ff0000">51</FONT>) <FONT COLOR="#008000">usuario</FONT>
                    MOVE <FONT COLOR="#008000">PARAMETRO</FONT>(<FONT COLOR="#ff0000">1</FONT>:<FONT COLOR="#ff0000">29</FONT>) TO <FONT COLOR="#008000">usuario</FONT>
                    EXEC <FONT COLOR="#008080">COBOLware <A HREF="pack.html">Pack String</A></FONT> <FONT COLOR="#008000">usuario</FONT> <FONT COLOR="#008080">WIDTH</FONT> <FONT COLOR="#008000">I</FONT> END-EXEC
                    COMPUTE <FONT COLOR="#008000">C</FONT> = <FONT COLOR="#ff0000">80</FONT> - <FONT COLOR="#008000">I</FONT> + <FONT COLOR="#ff0000">1</FONT>
                    DISPLAY (<FONT COLOR="#ff0000">1</FONT>, <FONT COLOR="#008000">C</FONT>) <FONT COLOR="#008000">usuario</FONT> WITH SIZE <FONT COLOR="#008000">I</FONT>
                    MOVE <FONT COLOR="#008000">parametro2</FONT>(<FONT COLOR="#ff0000">1</FONT>:<FONT COLOR="#ff0000">50</FONT>) TO <FONT COLOR="#008000">curdir</FONT>
           END-EVALUATE.

       <FONT COLOR="#008000">000-99-FIM</FONT>. GOBACK.<BR>
       END PROGRAM <FONT COLOR="#ff0000">FRAME</FONT>.</PRE>
</BODY>
</HTML>
