* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   1
*                      SAMPLE1.cbl
* Options: NOLIST NOASMLIST OMF(OBJ) OBJ(.\) list(SAMPLE1.lst) xnim
     1*
     2*>PARM DEBUG(FLOW FLDCHK)
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID.    SAMPLE1.
     5 AUTHOR.        Traduzido de Easytrieve (macro esy.kex v.0.10).
     6 DATE-WRITTEN.  08/03/2021 08:41:13 08:41:18.
     7 SECURITY.      *************************************************
     8                *                                               *
     9                * Gera relatorios:                              *
    10                *                                               *
    11                * UPD-RPT:                                      *
    12                * ANNUAL UPDATE REPORT - SALARIED EMPLOYEES     *
    13                *                                               *
    14                * BONUSRPT:                                     *
    15                * ANNUAL BONUS REPORT - SENIOR EMPLOYEES        *
    16                *                                               *
    17                *                                               *
    18                *************************************************
    19                *            KEDIT 5.50 X16 32-BIT NOV 27 2007  *
    20                *************************************************
    21 ENVIRONMENT DIVISION.
    22 CONFIGURATION SECTION.
    23 SPECIAL-NAMES. DECIMAL-POINT IS COMMA
    24                SYSOUT        IS ERRPRINT.
    25 INPUT-OUTPUT SECTION.
    26 FILE-CONTROL.
    27*
    28     SELECT PERSNL ASSIGN TO SYS010
    29            ORGANIZATION  IS SEQUENTIAL
    30            FILE STATUS   IS FL-STA-PERSNL.
    31*
    32     SELECT WORKSDS ASSIGN TO WORKSDS
    33            ORGANIZATION IS INDEXED
    34            ACCESS MODE  IS DYNAMIC
    35            RECORD KEY   IS WORKSDS-KEY
    36                            WITH DUPLICATES
    37            FILE STATUS  IS FL-STA-WORKSDS.
    38*
    39     SELECT UPD-RPT ASSIGN TO UPDRPT.
    40*
    41     SELECT BONUSRPT ASSIGN TO BONUSRPT.
    42*
    43 DATA DIVISION.
    44 FILE SECTION.
    45*
    46 FD  PERSNL
    47     RECORDING MODE IS FIXED
    48     RECORD CONTAINS 150 CHARACTERS
    49     BLOCK CONTAINS 12 RECORDS.
    50*
    51 01  REG-PERSNL.
    52     03 FILLER                         PIC  X(016).
    53     03 NAME.
    54        04 LAST-NAME                   PIC  X(008).
    55        04 FILLER                      PIC  X(008).
    56     03 FILLER                         PIC  X(061).
    57     03 PAY-GROSS                      PIC S9(004)V9(02) COMP-3.
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   2
*                      SAMPLE1.cbl
    58     03 DEPT                           PIC  9(003).
    59     03 FILLER                         PIC  X(035).
    60     03 DATE-OF-HIRE                   PIC  9(006).
    61     03 REDEFINES DATE-OF-HIRE.
    62        04 HIRE-MM                     PIC  9(002).
    63        04 HIRE-DD                     PIC  9(002).
    64        04 HIRE-YY                     PIC  9(002).
    65     03 FILLER                         PIC  X(009).
    66*
    67 FD  UPD-RPT
    68     LABEL RECORD IS OMITTED.
    69*
    70 01  REG-UPD-RPT                       PIC  X(063).
    71*
    72 FD  BONUSRPT
    73     LABEL RECORD IS OMITTED.
    74*
    75 01  REG-BONUSRPT                      PIC  X(060).
    76*
    77 FD  WORKSDS
    78     RECORD CONTAINS 1024 CHARACTERS
    79     BLOCK CONTAINS 0 RECORDS.
    80*
    81 01  REG-WORKSDS.
    82     03 WORKSDS-KEY.
    83        06 WORKSDS-REPORT              PIC  X(008).
    84        06 WORKSDS-STRING.
    85           09 WORKSDS-SEQUENCE         PIC  9(017).
    86     03 FILLER                         PIC  X(999).
    87*
    88 01  REG-WORKSDS-UPD-RPT.
    89     03 FILLER                         PIC  X(008).
    90     03 WORKSDS-UPD-RPT.
    91        06 UPD-RPT-DEPT                PIC 9(003).
    92        06 UPD-RPT-LAST-NAME           PIC  X(008).
    93        06 UPD-RPT-SERVICE             PIC  9(002).
    94        06 UPD-RPT-RAISE               PIC S9(004)V99.
    95        06 UPD-RPT-SALARY              PIC S9(004)V99.
    96        06 FILLER                      PIC  X(991).
    97*
    98 01  REG-WORKSDS-BONUSRPT.
    99     03 FILLER                         PIC  X(008).
   100     03 WORKSDS-BONUSRPT.
   101        06 BONUSRPT-DEPT               PIC 9(003).
   102        06 BONUSRPT-LAST-NAME          PIC  X(008).
   103        06 BONUSRPT-SERVICE            PIC  9(002).
   104        06 BONUSRPT-BONUS              PIC S9(004)V99.
   105        06 FILLER                      PIC  X(997).
   106*================================================================*
   107 WORKING-STORAGE SECTION.
   108*================================================================*
   109 77  FILLER                     PIC  X(31)  VALUE
   110                               'III WORKING-STORAGE SECTION III'.
   111*================================================================*
   112*----------------------------------------------------------------*
   113*        SUBPROGRAMAS                                            *
   114*----------------------------------------------------------------*
   115*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   3
*                      SAMPLE1.cbl
   116 77  SB-CANCEL                     PIC  X(08)  VALUE '$CANCEL'.
   117 77  SB-SC5CP                      PIC  X(08)  VALUE '$SC5CP'.
   118*
   119*----------------------------------------------------------------*
   120*-- VARIAVEIS PARA CHAMADA $SC5CP - VER AMBIENTE EXECUCAO        *
   121*----------------------------------------------------------------*
   122 01  WRETCODE.
   123     03 WRETC                          PIC  X.
   124     03 WRETCSUB                       PIC  X.
   125     03 WMACRO                         PIC  X(8).
   126     03 WRC                            PIC  9(9)         COMP.
   127     03 WRS                            PIC  9(9)         COMP.
   128 01  WFUNCAO                           PIC  X(5)   VALUE 'AMB'.
   129 01  WDADOS.
   130     03 WAMB                           PIC  X(3)   VALUE SPACES.
   131     03 WCPUID                         PIC  X(4)   VALUE SPACES.
   132*
   133*----------------------------------------------------------------*
   134* CAMPOS DE DATA E HORA                                          *
   135*----------------------------------------------------------------*
   136*
   137 01  WDATAAAMMDD.
   138     03 WDATAAA                        PIC  X(04)  VALUE SPACES.
   139     03 WDATAMM                        PIC  X(02)  VALUE SPACES.
   140     03 WDATADD                        PIC  X(02)  VALUE SPACES.
   141*
   142 01  WS-DATA-HORA.
   143     03  WS-DATACURRENT.
   144         05 WS-ANO-DATA                PIC  X(04)  VALUE SPACES.
   145         05 WS-MES-DATA                PIC  X(02)  VALUE SPACES.
   146         05 WS-DIA-DATA                PIC  X(02)  VALUE SPACES.
   147     03  WS-HORACURRENT.
   148         05 WS-HOR-HORA                PIC  X(02)  VALUE SPACES.
   149         05 WS-MIN-HORA                PIC  X(02)  VALUE SPACES.
   150         05 WS-SEG-HORA                PIC  X(02)  VALUE SPACES.
   151         05 WS-CEN-HORA                PIC  X(02)  VALUE SPACES.
   152 01  FILLER REDEFINES     WS-DATA-HORA.
   153     03  SYSDATE-LONG                  PIC  9(008).
   154     03  FILLER REDEFINES SYSDATE-LONG.
   155         05 FILLER                     PIC  X(002).
   156         05 SYSDATE                    PIC  9(006).
   157     03  SYSTIME                       PIC  9(008).
   158*
   159 01  WS-DATA-HORADISP.
   160     03  WS-DATADISP.
   161         05  WS-DIA-DISP               PIC  X(02)  VALUE SPACES.
   162         05  FILLER                    PIC  X(01)  VALUE '/'.
   163         05  WS-MES-DISP               PIC  X(02)  VALUE SPACES.
   164         05  FILLER                    PIC  X(01)  VALUE '/'.
   165         05  WS-ANO-DISP               PIC  X(04)  VALUE SPACES.
   166         05  FILLER                    PIC  X(02)  VALUE SPACES.
   167     03  WS-HORACURRENTP.
   168         05  WS-HOR-DISP               PIC  X(02)  VALUE SPACES.
   169         05  FILLER                    PIC  X(01)  VALUE ':'.
   170         05  WS-MIN-DISP               PIC  X(02)  VALUE SPACES.
   171         05  FILLER                    PIC  X(01)  VALUE ':'.
   172         05  WS-SEG-DISP               PIC  X(02)  VALUE SPACES.
   173*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   4
*                      SAMPLE1.cbl
   174*----------------------------------------------------------------*
   175*        LINHAS DE IMPRESSAO DO RELATORIO UPD-RPT                *
   176*----------------------------------------------------------------*
   177*
   178 01  UPD-RPT-LAYOUT.
   179 02  UPD-RPT-TIT1.
   180     05 FILLER                         PIC  X(011) VALUE SPACES.
   181     05 FILLER                         PIC  X(041) VALUE
   182        "ANNUAL UPDATE REPORT - SALARIED EMPLOYEES".
   183 02  UPD-RPT-TOP1.
   184     05 FILLER                         PIC  X(012) VALUE SPACES.
   185     05 FILLER                         PIC  X(041) VALUE
   186        "DEPT  NAME      SERV     RAISE     SALARY".
   187 02  UPD-RPT-DET1.
   188     05 FILLER                         PIC  X(012) VALUE SPACES.
   189     05 UPD-RPT-DET1-DEPT              PIC  9(003) VALUE ZEROS.
   190     05 FILLER                         PIC  X(003) VALUE SPACES.
   191     05 UPD-RPT-DET1-LAST-NAME         PIC  X(008) VALUE SPACES.
   192     05 FILLER                         PIC  X(003) VALUE SPACES.
   193     05 UPD-RPT-DET1-SERVICE           PIC  9(002) VALUE ZEROS.
   194     05 FILLER                         PIC  X(003) VALUE SPACES.
   195     05 UPD-RPT-DET1-RAISE             PIC  Z.ZZ9,99.
   196     05 FILLER                         PIC  X(003) VALUE SPACES.
   197     05 UPD-RPT-DET1-SALARY            PIC  Z.ZZ9,99.
   198 02  UPD-RPT-SUM1.
   199     05 FILLER                         PIC  X(012) VALUE SPACES.
   200     05 UPD-RPT-SUM1-CAPTION           PIC  X(005) VALUE SPACES.
   201     05 FILLER                         PIC  X(013) VALUE SPACES.
   202     05 UPD-RPT-SUM1-RAISE             PIC  Z.ZZZ.ZZ9,99.
   203     05 FILLER                         PIC  X(001) VALUE SPACE.
   204     05 UPD-RPT-SUM1-SALARY            PIC  ZZZ.ZZ9,99.
   205*
   206*----------------------------------------------------------------*
   207*        LINHAS DE IMPRESSAO DO RELATORIO BONUSRPT               *
   208*----------------------------------------------------------------*
   209*
   210 01  BONUSRPT-LAYOUT.
   211 02  BONUSRPT-TIT1.
   212     05 FILLER                         PIC  X(011) VALUE SPACES.
   213     05 FILLER                         PIC  X(038) VALUE
   214        "ANNUAL BONUS REPORT - SENIOR EMPLOYEES".
   215 02  BONUSRPT-TOP1.
   216     05 FILLER                         PIC  X(015) VALUE SPACES.
   217     05 FILLER                         PIC  X(031) VALUE
   218        "DEPT  LAST-NAME SERVIC E  BONUS".
   219 02  BONUSRPT-DET1.
   220     05 FILLER                         PIC  X(016) VALUE SPACES.
   221     05 BONUSRPT-DET1-DEPT             PIC  9(003) VALUE ZEROS.
   222     05 FILLER                         PIC  X(003) VALUE SPACES.
   223     05 BONUSRPT-DET1-LAST-NAME        PIC  X(008) VALUE SPACES.
   224     05 FILLER                         PIC  X(003) VALUE SPACES.
   225     05 BONUSRPT-DET1-SERVICE          PIC  9(002) VALUE ZEROS.
   226     05 FILLER                         PIC  X(003) VALUE SPACES.
   227     05 BONUSRPT-DET1-BONUS            PIC  Z.ZZ9,99.
   228*----------------------------------------------------------------*
   229**** VARIAVEIS DE CONTROLE DOS RELATORIOS                        *
   230*----------------------------------------------------------------*
   231*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   5
*                      SAMPLE1.cbl
   232 01  WS-CONTROLE-RELATORIOS.
   233 02  WS-DISPLAYS.
   234     03 SALARY                         PIC S9(004)V99 COMP-3 VALUE
   235        ZEROS.
   236     03 BONUS                          PIC S9(004)V99 COMP-3 VALUE
   237        ZEROS.
   238     03 RAISE                          PIC S9(004)V99 COMP-3 VALUE
   239        ZEROS.
   240     03 SERVICE                        PIC  9(002)    VALUE ZEROS.
   241 02  WS-COMPACTADOS COMP-3.
   242     03 BREAK-LEVEL                    PIC  9(003).
   243     03 LEVEL                          PIC  9(003).
   244     03 LINE-COUNT                     PIC  9(018).
   245        88 REPORT-CLOSED                           VALUE ZERO.
   246     03 DETAIL-COUNT                   PIC  9(018).
   247        88 FIRST-DETAIL                            VALUE 0.
   248     03 PAGE-COUNT                     PIC  9(018).
   249     03 UPD-RPT-SUM-RAISE  OCCURS 2    PIC S9(016)V9(02).
   250     03 UPD-RPT-SUM-SALARY OCCURS 2    PIC S9(016)V9(02).
   251     03 I                              PIC  9(008)   VALUE ZEROS.
   252*
   253*----------------------------------------------------------------*
   254*        AREA DE VARIAVES AUXILIARES                             *
   255*----------------------------------------------------------------*
   256*
   257 01  WS-VARIAVEIS.
   258     03 TRACOS                         PIC  X(118)    VALUE
   259        ALL '-'.
   260     03 PGMID                          PIC  X(009)    VALUE
   261        '#SAMPLE1.'.
   262     03 WS-DISPLAY                     PIC  -ZZZ.ZZZ.ZZZ.ZZZ.ZZ9.
   263     03 CURR-DATE                      PIC  9(006)    VALUE ZEROS.
   264     03 REDEFINES CURR-DATE.
   265        04 CURR-MM                     PIC  9(002).
   266        04 CURR-DD                     PIC  9(002).
   267        04 CURR-YY                     PIC  9(002).
   268     03 FL-STA-PERSNL                  PIC  X(002)    VALUE ZEROS.
   269        88 FL-PERSNL-EOF                              VALUE '10'.
   270        88 FL-PERSNL-OK                               VALUE '00'.
   271     03 FL-STA-WORKSDS                 PIC  X(002)    VALUE ZEROS.
   272        88 FL-WORKSDS-DUPALT                          VALUE '02'.
   273        88 FL-WORKSDS-DUPKEY                          VALUE '22'.
   274        88 FL-WORKSDS-EOF                             VALUE '10'.
   275        88 FL-WORKSDS-NEW                             VALUE '05'.
   276        88 FL-WORKSDS-OK                              VALUE '00'.
   277     03 BUFFER                         PIC  X(063)    VALUE ZEROS.
   278     03 WS-GRAVADOS-WORKSDS     COMP-3 PIC S9(017)    VALUE ZEROS.
   279     03 WS-LIDOS-PERSNL         COMP-3 PIC S9(017)    VALUE ZEROS.
   280     03 WS-LIDOS-WORKSDS        COMP-3 PIC S9(017)    VALUE ZEROS.
   281     03 WS-ULT-LIDO-PERSNL             PIC  X(150)    VALUE SPACE.
   282     03 WS-ULT-LIDO-WORKSDS            PIC  X(1024)   VALUE SPACE.
   283*
   284*----------------------------------------------------------------*
   285*--> AREA MONTAR TABELAS                                         *
   286*----------------------------------------------------------------*
   287*
   288 01  WS-TABELA-FIXA.
   289*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   6
*                      SAMPLE1.cbl
   290  03  WS-OCOR1-MENSAGEM.
   291    05  WS-OCOR1-LAYOUT                PIC  X(004) VALUE 'QSAM'.
   292    05  WS-OCOR1-SECTION-PGM           PIC  X(032) VALUE
   293    'ABRIR-ENTRADA-PERSNL'.
   294    05  WS-OCOR1-COD-MSG               PIC  X(004) VALUE '0001'.
   295    05  WS-OCOR1-COMPL                 PIC  X(100) VALUE
   296    'ERRO DE ABERTURA DO ARQUIVO PERSNL'.
   297    05  WS-OCOR1-QSAM-MSG.
   298      07  WS-OCOR1-QSAM-STAT           PIC  X(002) VALUE SPACES.
   299      07  WS-OCOR1-QSAM-DDN            PIC  X(008) VALUE 'SYS010'.
   300    05  FILLER                         PIC  X(182) VALUE SPACES.
   301*
   302  03  WS-OCOR2-MENSAGEM.
   303    05  WS-OCOR2-LAYOUT                PIC  X(004) VALUE 'QSAM'.
   304    05  WS-OCOR2-SECTION-PGM           PIC  X(032) VALUE
   305    'RT-LER-PERSNL'.
   306    05  WS-OCOR2-COD-MSG               PIC  X(004) VALUE '0002'.
   307    05  WS-OCOR2-COMPL                 PIC  X(100) VALUE
   308    'ERRO DE LEITURA DO ARQUIVO PERSNL'.
   309    05  WS-OCOR2-QSAM-MSG.
   310      07  WS-OCOR2-QSAM-STAT           PIC  X(002) VALUE SPACES.
   311      07  WS-OCOR2-QSAM-DDN            PIC  X(008) VALUE 'SYS010'.
   312    05  FILLER                         PIC  X(182) VALUE SPACES.
   313*
   314  03  WS-OCOR3-MENSAGEM.
   315    05  WS-OCOR3-LAYOUT                PIC  X(004) VALUE 'QSAM'.
   316    05  WS-OCOR3-SECTION-PGM           PIC  X(032) VALUE
   317    'RT-FECHAR-PERSNL'.
   318    05  WS-OCOR3-COD-MSG               PIC  X(004) VALUE '0003'.
   319    05  WS-OCOR3-COMPL                 PIC  X(100) VALUE
   320    'ERRO AO FECHAR O ARQUIVO PERSNL'.
   321    05  WS-OCOR3-QSAM-MSG.
   322      07  WS-OCOR3-QSAM-STAT           PIC  X(002) VALUE SPACES.
   323      07  WS-OCOR3-QSAM-DDN            PIC  X(008) VALUE 'SYS010'.
   324    05  FILLER                         PIC  X(182) VALUE SPACES.
   325*
   326  03  WS-OCOR4-MENSAGEM.
   327    05  WS-OCOR4-LAYOUT                PIC  X(004) VALUE 'QSAM'.
   328    05  WS-OCOR4-SECTION-PGM           PIC  X(032) VALUE
   329    'ABRIR-ATUALIZAR-WORKSDS'.
   330    05  WS-OCOR4-COD-MSG               PIC  X(004) VALUE '0004'.
   331    05  WS-OCOR4-COMPL                 PIC  X(100) VALUE
   332    'ERRO DE ABERTURA DO ARQUIVO WORKSDS'.
   333    05  WS-OCOR4-QSAM-MSG.
   334      07  WS-OCOR4-QSAM-STAT           PIC  X(002) VALUE SPACES.
   335      07  WS-OCOR4-QSAM-DDN            PIC  X(008) VALUE
   336         'WORKSDS'.
   337    05  FILLER                         PIC  X(182) VALUE SPACES.
   338*
   339  03  WS-OCOR5-MENSAGEM.
   340    05  WS-OCOR5-LAYOUT                PIC  X(004) VALUE 'QSAM'.
   341    05  WS-OCOR5-SECTION-PGM           PIC  X(032) VALUE
   342    'RT-LER-WORKSDS'.
   343    05  WS-OCOR5-COD-MSG               PIC  X(004) VALUE '0005'.
   344    05  WS-OCOR5-COMPL                 PIC  X(100) VALUE
   345    'ERRO DE LEITURA DO ARQUIVO WORKSDS'.
   346    05  WS-OCOR5-QSAM-MSG.
   347      07  WS-OCOR5-QSAM-STAT           PIC  X(002) VALUE SPACES.
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   7
*                      SAMPLE1.cbl
   348      07  WS-OCOR5-QSAM-DDN            PIC  X(008) VALUE
   349         'WORKSDS'.
   350    05  FILLER                         PIC  X(182) VALUE SPACES.
   351*
   352  03  WS-OCOR6-MENSAGEM.
   353    05  WS-OCOR6-LAYOUT                PIC  X(004) VALUE 'QSAM'.
   354    05  WS-OCOR6-SECTION-PGM           PIC  X(032) VALUE
   355    'RT-GRAVAR-WORKSDS'.
   356    05  WS-OCOR6-COD-MSG               PIC  X(004) VALUE '0006'.
   357    05  WS-OCOR6-COMPL                 PIC  X(100) VALUE
   358    'ERRO DE GRAVACAO NO ARQUIVO WORKSDS'.
   359    05  WS-OCOR6-QSAM-MSG.
   360      07  WS-OCOR6-QSAM-STAT           PIC  X(002) VALUE SPACES.
   361      07  WS-OCOR6-QSAM-DDN            PIC  X(008) VALUE
   362         'WORKSDS'.
   363      07  FILLER                       PIC  X(015) VALUE
   364         ' WORKSDS-KEY = '.
   365      07  WS-OCOR6-WORKSDS-KEY         PIC  X(015) VALUE SPACES.
   366    05  FILLER                         PIC  X(152) VALUE SPACES.
   367*
   368 01  WS-TABELA-ALTER.
   369  03  WS-TABELA-ALTERX   OCCURS 6 TIMES INDEXED BY INDALT.
   370   05 WS-ALTER-LAYOUT                  PIC  X(004).
   371   05 WS-ALTER-SECTION-PGM             PIC  X(032).
   372   05 WS-ALTER-COD-MSG                 PIC  X(004).
   373   05 WS-ALTER-COMPL                   PIC  X(100).
   374   05 WS-ALTER-QSAM-MSG                PIC  X(190).
   375*
   376*----------------------------------------------------------------*
*  377 COPY 'SC5LDIS1'.
   378 77 SC5LDIS1-LAYOUT       PIC X(4).
   379 77 SC5LDIS1-SECTION-PGM  PIC X(32).
   380 77 SC5LDIS1-COD-MSG      PIC X(4).
   381 77 SC5LDIS1-QSAM-MSG     PIC X(60).
   382 77 SC5LDIS1-AREAMSG      PIC X(9).
   383 77 SC5LDIS1-PGM          PIC X(8).
   384*================================================================*
   385 01  FILLER                            PIC  X(32)  VALUE
   386                               'FFF  FIM DAWORKING-STORAGE  FFF'.
   387*================================================================*
   388*                                                                *
   389*================================================================*
   390 PROCEDURE DIVISION.
   391*================================================================*
   392*                                                                *
   393*----------------------------------------------------------------*
   394*                        ROTINA PRINCIPAL                        *
   395*----------------------------------------------------------------*
   396 RT-PRINCIPAL                                SECTION.
   397*
   398     PERFORM RT-INICIAR
   399*
   400     PERFORM RT-PROCESSAR
   401*
   402     PERFORM RT-FINALIZAR
   403*
   404     MOVE ZEROS TO RETURN-CODE
   405*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   8
*                      SAMPLE1.cbl
   406     GOBACK.
   407*
   408 RT-PRINCIPALX.                              EXIT.
   409*----------------------------------------------------------------*
   410*                     ROTINA DE INICIALIZACAO                    *
   411*----------------------------------------------------------------*
   412 RT-INICIAR                                  SECTION.
   413*
   414     DISPLAY PGMID '001I ' FUNCTION WHEN-COMPILED
   415     PERFORM RT-OBTER-AMBIENTE
   416     MOVE HIGH-VALUES TO UPD-RPT-DET1-DEPT              (1:)
   417*
   418     PERFORM RT-OBTER-HORA
   419*
   420     DISPLAY PGMID '001I' TRACOS
   421     DISPLAY PGMID '001I- INICIO PROC: ' WS-DATA-HORADISP
   422     DISPLAY PGMID '001I' TRACOS
   423*
   424     PERFORM RT-ABRIR-ATUALIZAR-WORKSDS.
   425*
   426 RT-INICIARX.                                EXIT.
   427*----------------------------------------------------------------*
   428*               ROTINA PARA PROCESSAMENTO PRINCIPAL              *
   429*----------------------------------------------------------------*
   430 RT-PROCESSAR                                SECTION.
   431*
   432     PERFORM RT-ABRIR-ENTRADA-PERSNL
   433*
   434     PERFORM RT-ENTRADA-PERSNL
   435             UNTIL FL-PERSNL-EOF
   436*
   437     PERFORM RT-FECHAR-PERSNL.
   438*
   439 SERVICE-CALC.
   440*
   441     COMPUTE SERVICE = CURR-YY - HIRE-YY
   442     IF CURR-MM LESS HIRE-MM
   443        SUBTRACT 1 FROM SERVICE
   444     END-IF
   445     IF CURR-MM NOT EQUAL HIRE-MM
   446        GO TO QUIT-SERV-CALC
   447     END-IF
   448     IF CURR-DD LESS HIRE-DD
   449        SUBTRACT 1 FROM SERVICE
   450     END-IF.
   451 QUIT-SERV-CALC.
   452*
   453 RAISE-CALC.
   454*
   455     IF DEPT LESS 940
   456        COMPUTE RAISE = SALARY * 0,1
   457     ELSE
   458        COMPUTE RAISE = SALARY * 0,15
   459     END-IF.
   460*
   461 BONUS-CALC.
   462*
   463     IF SALARY GREATER 29999
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page   9
*                      SAMPLE1.cbl
   464        DISPLAY PGMID '200I- ' LAST-NAME '     '
   465                'INELIGIBLE FOR BONUS' UPON ERRPRINT
   466        GO TO QUIT-BONUS
   467     END-IF
   468     IF SERVICE GREATER 19
   469        MOVE 2000 TO BONUS
   470     ELSE
   471        MOVE 1000 TO BONUS
   472     END-IF
   473     PERFORM RT-CARREGA-BONUSRPT.
   474 QUIT-BONUS.
   475*
   476     MOVE HIGH-VALUES         TO WORKSDS-KEY
   477     MOVE 'UPD-RPT'           TO WORKSDS-REPORT
   478     PERFORM RT-GRAVAR-WORKSDS
   479     MOVE HIGH-VALUES         TO WORKSDS-KEY
   480     MOVE 'BONUSRPT'          TO WORKSDS-REPORT
   481     PERFORM RT-GRAVAR-WORKSDS
   482*
   483     PERFORM RT-GERA-RELATORIOS.
   484*
   485 RT-PROCESSARX.                              EXIT.
   486*----------------------------------------------------------------*
   487*              OBTER AMBIENTE DE EXECUCAO DO SAMPLE1             *
   488*----------------------------------------------------------------*
   489 RT-OBTER-AMBIENTE                           SECTION.
   490*
   491     CALL SB-SC5CP USING WRETCODE WFUNCAO WDADOS
   492**      WABM   DES/HOM/PRD
   493     IF WRETC  NOT = '0'
   494        MOVE 'DES'              TO WAMB
   495     END-IF.
   496*
   497 RT-OBTER-AMBIENTEX.                         EXIT.
   498*----------------------------------------------------------------*
   499*         ROTINA PARA OBTER DATA E HORA DO PROCESSAMENTO         *
   500*----------------------------------------------------------------*
   501 RT-OBTER-HORA                               SECTION.
   502*
   503     MOVE FUNCTION CURRENT-DATE(1:20)
   504                                 TO WS-DATA-HORA
   505     MOVE WS-ANO-DATA            TO WS-ANO-DISP
   506     MOVE WS-MES-DATA            TO WS-MES-DISP
   507     MOVE WS-DIA-DATA            TO WS-DIA-DISP
   508     MOVE WS-HOR-HORA            TO WS-HOR-DISP
   509     MOVE WS-MIN-HORA            TO WS-MIN-DISP
   510     MOVE WS-SEG-HORA            TO WS-SEG-DISP
   511*
   512     MOVE WS-ANO-DATA            TO WDATAAA
   513     MOVE WS-MES-DATA            TO WDATAMM
   514     MOVE WS-DIA-DATA            TO WDATADD.
   515*
   516 RT-OBTER-HORAX.                             EXIT.
   517*----------------------------------------------------------------*
   518*                     ROTINA DE CANCELAMENTO                     *
   519*----------------------------------------------------------------*
   520 RT-CANCELAR                                 SECTION.
   521*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  10
*                      SAMPLE1.cbl
   522     DISPLAY PGMID '900I' TRACOS
   523     DISPLAY PGMID '900I- ESTATISTICA AUXILIAR PARA CANCEL'
   524     DISPLAY PGMID '900I' TRACOS
   525*
   526     MOVE    WS-LIDOS-PERSNL                         TO WS-DISPLAY
   527     DISPLAY PGMID '002I- LIDOS DE PERSNL............:' WS-DISPLAY
   528     MOVE    WS-LIDOS-WORKSDS                        TO WS-DISPLAY
   529     DISPLAY PGMID '005I- LIDOS DE WORKSDS...........:' WS-DISPLAY
   530     MOVE    WS-GRAVADOS-WORKSDS                     TO WS-DISPLAY
   531     DISPLAY PGMID '006I- GRAVADOS EM WORKSDS........:' WS-DISPLAY
   532     DISPLAY PGMID '900I' TRACOS
   533*
   534     DISPLAY PGMID '002I- ULTIMO LIDO DE PERSNL:'
   535             WS-ULT-LIDO-PERSNL
   536     DISPLAY PGMID '005I- ULTIMO LIDO DE WORKSDS:'
   537             WS-ULT-LIDO-WORKSDS
   538     CALL SB-CANCEL.
   539*
   540 RT-CANCELARX.                               EXIT.
   541*----------------------------------------------------------------*
   542*            ROTINA DE FINALIZACAO DO PROGRAMA SAMPLE1           *
   543*----------------------------------------------------------------*
   544 RT-FINALIZAR                                SECTION.
   545*
   546     PERFORM RT-OBTER-HORA
   547*
   548     DISPLAY PGMID '999I' TRACOS
   549     DISPLAY PGMID '999I- FIM DE PROC: ' WS-DATA-HORADISP
   550     DISPLAY PGMID '999I' TRACOS
   551     DISPLAY PGMID '999I- ESTATISTICA DE PROCESSAMENTO'
   552     DISPLAY PGMID '999I' TRACOS
   553     MOVE    WS-LIDOS-PERSNL                         TO WS-DISPLAY
   554     DISPLAY PGMID '002I- LIDOS DE PERSNL............:' WS-DISPLAY
   555     MOVE    WS-LIDOS-WORKSDS                        TO WS-DISPLAY
   556     DISPLAY PGMID '005I- LIDOS DE WORKSDS...........:' WS-DISPLAY
   557     MOVE    WS-GRAVADOS-WORKSDS                     TO WS-DISPLAY
   558     DISPLAY PGMID '006I- GRAVADOS EM WORKSDS........:' WS-DISPLAY
   559     DISPLAY PGMID '999I' TRACOS.
   560*
   561     CLOSE WORKSDS.
   562*
   563 RT-FINALIZARX.                              EXIT.
   564*
   565*----------------------------------------------------------------*
   566*                     ABRIR O ARQUIVO PERSNL                     *
   567*----------------------------------------------------------------*
   568 RT-ABRIR-ENTRADA-PERSNL                     SECTION.
   569*
   570     OPEN INPUT PERSNL
   571     IF  NOT FL-PERSNL-OK
   572         SET INDALT TO 1
   573         PERFORM RT-MONTA-MSG
   574     END-IF.
   575*
   576 RT-ABRIR-ENTRADA-PERSNLX.                   EXIT.
   577*----------------------------------------------------------------*
   578*            ROTINA ENTRADA-PERSNL (DE JOB EASYTRIEVE)           *
   579*----------------------------------------------------------------*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  11
*                      SAMPLE1.cbl
   580 RT-ENTRADA-PERSNL                           SECTION.
   581*
   582     PERFORM RT-LER-PERSNL
   583     IF  FL-PERSNL-EOF
   584         EXIT SECTION
   585     END-IF
   586*    * Macro "GETDATE.ESY" carregada OK.
   587     PERFORM RT-OBTER-HORA
   588     MOVE SYSDATE TO CURR-DATE
   589*    * Fim da macro GETDATE.ESY
   590     COMPUTE SALARY = PAY-GROSS * 52
   591     PERFORM SERVICE-CALC
   592     IF SERVICE LESS 1
   593        EXIT SECTION
   594     END-IF
   595     PERFORM RAISE-CALC
   596     MOVE ZERO TO BONUS
   597     IF SERVICE GREATER 14
   598        PERFORM BONUS-CALC
   599     END-IF
   600     COMPUTE SALARY = SALARY + RAISE + BONUS
   601     PERFORM RT-CARREGA-UPD-RPT.
   602*    *
   603*
   604 RT-ENTRADA-PERSNLX.                         EXIT.
   605*----------------------------------------------------------------*
   606*        ROTINA PARA LEITURA SEQUENCIAL DO ARQUIVO PERSNL        *
   607*----------------------------------------------------------------*
   608 RT-LER-PERSNL                               SECTION.
   609*
   610    READ PERSNL INTO WS-ULT-LIDO-PERSNL
   611*
   612    IF  FL-PERSNL-OK
   613        ADD 1 TO WS-LIDOS-PERSNL
   614    ELSE
   615        IF  NOT FL-PERSNL-EOF
   616            SET INDALT TO 2
   617            PERFORM RT-MONTA-MSG
   618        ELSE
   619            IF  FL-PERSNL-EOF
   620            AND WS-LIDOS-PERSNL EQUAL ZERO
   621                DISPLAY PGMID '002I  *========================*'
   622                DISPLAY PGMID '002I  * ARQUIVO "PERSNL" VAZIO *'
   623                DISPLAY PGMID '002I  *========================*'
   624                DISPLAY PGMID '002I  DDN = SYS010'
   625            END-IF
   626        END-IF
   627    END-IF.
   628*
   629 RT-LER-PERSNLX.                             EXIT.
   630*----------------------------------------------------------------*
   631*                     FECHAR O ARQUIVO PERSNL                    *
   632*----------------------------------------------------------------*
   633 RT-FECHAR-PERSNL                            SECTION.
   634*
   635    CLOSE PERSNL
   636    IF  NOT FL-PERSNL-OK
   637        SET INDALT TO 3
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  12
*                      SAMPLE1.cbl
   638        PERFORM RT-MONTA-MSG
   639    END-IF.
   640*
   641 RT-FECHAR-PERSNLX.                          EXIT.
   642*----------------------------------------------------------------*
   643*                     ABRIR O ARQUIVO WORKSDS                    *
   644*----------------------------------------------------------------*
   645 RT-ABRIR-ATUALIZAR-WORKSDS                  SECTION.
   646*
   647     OPEN I-O WORKSDS
   648     IF  FL-WORKSDS-OK
   649         CLOSE WORKSDS
   650         DELETE FILE WORKSDS
   651         OPEN I-O WORKSDS
   652     END-IF
   653*
   654     IF  NOT FL-WORKSDS-OK
   655     AND NOT FL-WORKSDS-NEW
   656         SET INDALT TO 4
   657         PERFORM RT-MONTA-MSG
   658     END-IF.
   659*
   660 RT-ABRIR-ATUALIZAR-WORKSDSX.                EXIT.
   661*----------------------------------------------------------------*
   662*               ROTINA PARA GERACAO DE RELATORIO(S)              *
   663*----------------------------------------------------------------*
   664 RT-GERA-RELATORIOS                          SECTION.
   665*
   666     INITIALIZE WS-CONTROLE-RELATORIOS
   667     INITIALIZE WORKSDS-KEY
   668     START WORKSDS KEY NOT LESS WORKSDS-KEY
   669     PERFORM UNTIL FL-WORKSDS-EOF
   670          PERFORM RT-LER-WORKSDS
   671          IF FL-WORKSDS-OK
   672             EVALUATE WORKSDS-REPORT
   673                WHEN "UPD-RPT"
   674                      PERFORM RT-GERAR-RELATORIO-UPD-RPT
   675                WHEN "BONUSRPT"
   676                      PERFORM RT-GERAR-RELATORIO-BONUSRPT
   677             END-EVALUATE
   678          END-IF
   679     END-PERFORM.
   680*
   681 RT-GERA-RELATORIOSX.                        EXIT.
   682*----------------------------------------------------------------*
   683*        ROTINA PARA LEITURA SEQUENCIAL DO ARQUIVO WORKSDS       *
   684*----------------------------------------------------------------*
   685 RT-LER-WORKSDS                              SECTION.
   686*
   687    READ WORKSDS NEXT RECORD
   688*
   689    IF  FL-WORKSDS-OK
   690    OR  FL-WORKSDS-DUPALT
   691        ADD 1 TO WS-LIDOS-WORKSDS
   692    ELSE
   693        IF  NOT FL-WORKSDS-EOF
   694            SET INDALT TO 5
   695            PERFORM RT-MONTA-MSG
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  13
*                      SAMPLE1.cbl
   696        ELSE
   697            IF  FL-WORKSDS-EOF
   698            AND WS-LIDOS-WORKSDS EQUAL ZERO
   699                DISPLAY PGMID '005I  *=========================*'
   700                DISPLAY PGMID '005I  * ARQUIVO "WORKSDS" VAZIO *'
   701                DISPLAY PGMID '005I  *=========================*'
   702                DISPLAY PGMID '005I  DDN = WORKSDS'
   703            END-IF
   704        END-IF
   705    END-IF.
   706*
   707 RT-LER-WORKSDSX.                            EXIT.
   708*----------------------------------------------------------------*
   709*             ROTINA PARA GRAVACAO NO ARQUIVO WORKSDS            *
   710*----------------------------------------------------------------*
   711 RT-GRAVAR-WORKSDS                           SECTION.
   712*
   713    WRITE REG-WORKSDS
   714*
   715    IF  FL-WORKSDS-OK
   716    OR  FL-WORKSDS-DUPALT
   717        ADD 1 TO WS-GRAVADOS-WORKSDS
   718    ELSE
   719        IF   NOT FL-WORKSDS-DUPKEY
   720             SET INDALT TO 6
   721             PERFORM RT-MONTA-MSG
   722        END-IF
   723    END-IF.
   724*
   725 RT-GRAVAR-WORKSDSX.                         EXIT.
   726*----------------------------------------------------------------*
   727*                  GERACAO DO RELATORIO UPD-RPT                  *
   728*----------------------------------------------------------------*
   729 RT-GERAR-RELATORIO-UPD-RPT                  SECTION.
   730*
   731    EVALUATE TRUE
   732        WHEN WORKSDS-STRING EQUAL   HIGH-VALUES
   733             MOVE 2 TO BREAK-LEVEL
   734        WHEN UPD-RPT-DEPT GREATER UPD-RPT-DET1-DEPT
   735             MOVE 1 TO BREAK-LEVEL
   736        WHEN OTHER
   737             MOVE ZERO TO BREAK-LEVEL
   738    END-EVALUATE
   739*
   740    IF BREAK-LEVEL NOT EQUAL ZERO
   741       PERFORM VARYING LEVEL
   742               FROM    1
   743               BY      1
   744               UNTIL LEVEL GREATER BREAK-LEVEL
   745            EVALUATE LEVEL
   746                WHEN 1
   747                     MOVE UPD-RPT-DET1-DEPT
   748                       TO UPD-RPT-SUM1-CAPTION
   749                WHEN 2
   750                     MOVE 'FINAL' TO UPD-RPT-SUM1-CAPTION
   751            END-EVALUATE
   752            MOVE    UPD-RPT-SUM-RAISE(LEVEL)
   753              TO    UPD-RPT-SUM1-RAISE
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  14
*                      SAMPLE1.cbl
   754            MOVE    UPD-RPT-SUM-SALARY(LEVEL)
   755              TO    UPD-RPT-SUM1-SALARY
   756            MOVE  SPACES       TO REG-UPD-RPT
   757            PERFORM RT-IMPRIMIR-LINHA-UPD-RPT
   758            MOVE  UPD-RPT-SUM1 TO REG-UPD-RPT
   759            PERFORM RT-IMPRIMIR-LINHA-UPD-RPT
   760            INITIALIZE UPD-RPT-SUM-RAISE(LEVEL)
   761                       UPD-RPT-SUM-SALARY(LEVEL)
   762       END-PERFORM
   763    END-IF
   764*
   765    IF   WORKSDS-STRING EQUAL HIGH-VALUES
   766         CLOSE UPD-RPT
   767         INITIALIZE WS-CONTROLE-RELATORIOS
   768         EXIT SECTION
   769    END-IF
   770    PERFORM VARYING LEVEL
   771            FROM 2 BY -1
   772            UNTIL LEVEL EQUAL ZERO
   773        ADD UPD-RPT-RAISE             TO UPD-RPT-SUM-RAISE(LEVEL)
   774        ADD UPD-RPT-SALARY            TO UPD-RPT-SUM-SALARY(LEVEL)
   775    END-PERFORM
   776*
   777    MOVE    UPD-RPT-DEPT      TO UPD-RPT-DET1-DEPT
   778    MOVE    UPD-RPT-LAST-NAME TO UPD-RPT-DET1-LAST-NAME
   779    MOVE    UPD-RPT-SERVICE   TO UPD-RPT-DET1-SERVICE
   780    MOVE    UPD-RPT-RAISE     TO UPD-RPT-DET1-RAISE
   781    MOVE    UPD-RPT-SALARY    TO UPD-RPT-DET1-SALARY
   782    MOVE    UPD-RPT-DET1      TO BUFFER
   783    PERFORM RT-IMPRIMIR-LINHA-UPD-RPT
   784*
   785    ADD     1                         TO DETAIL-COUNT.
   786*
   787 RT-GERAR-RELATORIO-UPD-RPTX.                EXIT.
   788*----------------------------------------------------------------*
   789*       ROTINA DE IMPRESSAO DE LINHA DO UPD-RPT E CABECALHO      *
   790*----------------------------------------------------------------*
   791 RT-IMPRIMIR-LINHA-UPD-RPT                   SECTION.
   792*
   793    IF REPORT-CLOSED
   794       OPEN OUTPUT UPD-RPT
   795       MOVE 52               TO LINE-COUNT
   796    END-IF
   797*
   798    IF  LINE-COUNT NOT LESS 51
   799        PERFORM RT-IMPRIMIR-RODAPE-UPD-RPT
   800        ADD   1              TO PAGE-COUNT
   801        WRITE REG-UPD-RPT  FROM UPD-RPT-TIT1 AFTER PAGE
   802        WRITE REG-UPD-RPT  FROM UPD-RPT-TOP1 AFTER 2
   803        MOVE  SPACES         TO REG-UPD-RPT
   804        WRITE REG-UPD-RPT                    AFTER 1
   805        MOVE  4              TO LINE-COUNT
   806        SET   FIRST-DETAIL   TO TRUE
   807    END-IF.
   808*
   809    ADD   1                  TO LINE-COUNT
   810    WRITE REG-UPD-RPT FROM BUFFER            AFTER 1.
   811*.
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  15
*                      SAMPLE1.cbl
   812 RT-IMPRIMIR-LINHA-UPD-RPTX.                 EXIT.
   813*----------------------------------------------------------------*
   814*            ROTINA DE IMPRESSAO DO RODAPE DO UPD-RPT            *
   815*----------------------------------------------------------------*
   816 RT-IMPRIMIR-RODAPE-UPD-RPT                  SECTION.
   817*
   818    IF  LINE-COUNT EQUAL 52
   819        EXIT SECTION
   820    END-IF.
   821*
   822 RT-IMPRIMIR-RODAPE-UPD-RPTX.                EXIT.
   823*----------------------------------------------------------------*
   824*                  GERACAO DO RELATORIO BONUSRPT                 *
   825*----------------------------------------------------------------*
   826 RT-GERAR-RELATORIO-BONUSRPT                 SECTION.
   827*
   828    IF   WORKSDS-STRING EQUAL HIGH-VALUES
   829         CLOSE BONUSRPT
   830         INITIALIZE WS-CONTROLE-RELATORIOS
   831         EXIT SECTION
   832    END-IF
   833*
   834    MOVE    BONUSRPT-DEPT      TO BONUSRPT-DET1-DEPT
   835    MOVE    BONUSRPT-LAST-NAME TO BONUSRPT-DET1-LAST-NAME
   836    MOVE    BONUSRPT-SERVICE   TO BONUSRPT-DET1-SERVICE
   837    MOVE    BONUSRPT-BONUS     TO BONUSRPT-DET1-BONUS
   838    MOVE    BONUSRPT-DET1      TO BUFFER
   839    PERFORM RT-IMPRIMIR-LINHA-BONUSRPT
   840*
   841    ADD     1                           TO DETAIL-COUNT.
   842*
   843 RT-GERAR-RELATORIO-BONUSRPTX.               EXIT.
   844*----------------------------------------------------------------*
   845*      ROTINA DE IMPRESSAO DE LINHA DO BONUSRPT E CABECALHO      *
   846*----------------------------------------------------------------*
   847 RT-IMPRIMIR-LINHA-BONUSRPT                  SECTION.
   848*
   849    IF REPORT-CLOSED
   850       OPEN OUTPUT BONUSRPT
   851       MOVE 59               TO LINE-COUNT
   852    END-IF
   853*
   854    IF  LINE-COUNT NOT LESS 58
   855        PERFORM RT-IMPRIMIR-RODAPE-BONUSRPT
   856        ADD   1              TO PAGE-COUNT
   857        WRITE REG-BONUSRPT FROM BONUSRPT-TIT1 AFTER PAGE
   858        WRITE REG-BONUSRPT FROM BONUSRPT-TOP1 AFTER 2
   859        MOVE  SPACES         TO REG-BONUSRPT
   860        WRITE REG-BONUSRPT                    AFTER 1
   861        MOVE  4              TO LINE-COUNT
   862        SET   FIRST-DETAIL   TO TRUE
   863    END-IF.
   864*
   865    ADD   1                  TO LINE-COUNT
   866    WRITE REG-BONUSRPT FROM BUFFER            AFTER 1.
   867*.
   868 RT-IMPRIMIR-LINHA-BONUSRPTX.                EXIT.
   869*----------------------------------------------------------------*
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  16
*                      SAMPLE1.cbl
   870*            ROTINA DE IMPRESSAO DO RODAPE DO BONUSRPT           *
   871*----------------------------------------------------------------*
   872 RT-IMPRIMIR-RODAPE-BONUSRPT                 SECTION.
   873*
   874    IF  LINE-COUNT EQUAL 59
   875        EXIT SECTION
   876    END-IF.
   877*
   878 RT-IMPRIMIR-RODAPE-BONUSRPTX.               EXIT.
   879*----------------------------------------------------------------*
   880*     GRAVAR DADOS DA LINHA DO RELATORIO BONUSRPT NO WORKSDS     *
   881*----------------------------------------------------------------*
   882 RT-CARREGA-BONUSRPT                         SECTION.
   883*
   884    ADD  1                    TO WS-GRAVADOS-WORKSDS
   885    MOVE 'BONUSRPT'           TO REG-WORKSDS
   886    MOVE WS-GRAVADOS-WORKSDS TO WORKSDS-SEQUENCE
   887    MOVE DEPT                 TO BONUSRPT-DEPT
   888    MOVE LAST-NAME            TO BONUSRPT-LAST-NAME
   889    MOVE SERVICE              TO BONUSRPT-SERVICE
   890    MOVE BONUS                TO BONUSRPT-BONUS
   891    PERFORM RT-GRAVAR-WORKSDS.
   892*
   893 RT-CARREGA-BONUSRPTX.                       EXIT.
   894*----------------------------------------------------------------*
   895*      GRAVAR DADOS DA LINHA DO RELATORIO UPD-RPT NO WORKSDS     *
   896*----------------------------------------------------------------*
   897 RT-CARREGA-UPD-RPT                          SECTION.
   898*
   899    ADD  1                    TO WS-GRAVADOS-WORKSDS
   900    MOVE 'UPD-RPT'            TO REG-WORKSDS
   901    MOVE WS-GRAVADOS-WORKSDS TO WORKSDS-SEQUENCE
   902    MOVE DEPT                 TO UPD-RPT-DEPT
   903    MOVE LAST-NAME            TO UPD-RPT-LAST-NAME
   904    MOVE SERVICE              TO UPD-RPT-SERVICE
   905    MOVE RAISE                TO UPD-RPT-RAISE
   906    MOVE SALARY               TO UPD-RPT-SALARY
   907    PERFORM RT-GRAVAR-WORKSDS.
   908*
   909 RT-CARREGA-UPD-RPTX.                        EXIT.
   910*----------------------------------------------------------------*
   911*        ROTINA PARA MONTAR AS MENSAGENS DA TABELA DE ERRO       *
   912*----------------------------------------------------------------*
   913 RT-MONTA-MSG                                SECTION.
   914*
   915     MOVE WORKSDS-KEY             TO WS-OCOR6-WORKSDS-KEY
   916*
   917     MOVE FL-STA-PERSNL           TO WS-OCOR1-QSAM-STAT
   918                                     WS-OCOR2-QSAM-STAT
   919                                     WS-OCOR3-QSAM-STAT
   920*
   921     MOVE FL-STA-WORKSDS          TO WS-OCOR4-QSAM-STAT
   922                                     WS-OCOR5-QSAM-STAT
   923                                     WS-OCOR6-QSAM-STAT
   924*
   925     MOVE WS-TABELA-FIXA          TO WS-TABELA-ALTER
   926     MOVE WS-ALTER-LAYOUT(INDALT)
   927                                  TO SC5LDIS1-LAYOUT
* Micro Focus Object COBOL           V4.0 revision 038 08-Mar-21 08:41 Page  17
*                      SAMPLE1.cbl
   928     MOVE WS-ALTER-SECTION-PGM(INDALT)
   929                                  TO SC5LDIS1-SECTION-PGM
   930     MOVE WS-ALTER-COD-MSG(INDALT)
   931                                  TO SC5LDIS1-COD-MSG
   932     MOVE WS-ALTER-QSAM-MSG(INDALT)
   933                                  TO SC5LDIS1-QSAM-MSG
   934                                     SC5LDIS1-AREAMSG
   935*
   936     MOVE 'SAMPLE1'               TO SC5LDIS1-PGM.
   937*
   938     PERFORM RT-8888-FORMATAR-MSG-PAD.
   939*
   940     PERFORM RT-CANCELAR.
   941*
   942 RT-MONTA-MSGX.                              EXIT.
*  943 COPY 'SC5LDIS2'.
   944 RT-8888-FORMATAR-MSG-PAD SECTION.
   945     DISPLAY PGMID '5L2I' TRACOS
   946     DISPLAY PGMID '5L2I LAYOUT     ='   SC5LDIS1-LAYOUT
   947     DISPLAY PGMID '5L2I SECTION-PGM='   SC5LDIS1-SECTION-PGM
   948     DISPLAY PGMID '5L2I COD-MSG    ='   SC5LDIS1-COD-MSG
   949     DISPLAY PGMID '5L2I QSAM-MSG   ='   SC5LDIS1-QSAM-MSG
   950     DISPLAY PGMID '5L2I AREAMSG    ='   SC5LDIS1-AREAMSG
   951     DISPLAY PGMID '5L2I PGM        ='   SC5LDIS1-PGM
   952     DISPLAY PGMID '5L2I' TRACOS.
   953 RT-8888-FORMATAR-MSG-PADX. EXIT.
   954******************************************************************
   955*                      FIM  DO  PROGRAMA                         *
   956******************************************************************
* Micro Focus Object COBOL           V4.0 revision 038
* Copyright (C) 1984-1998 Micro Focus Ltd.     URN OXCNM/000047913 
*                                              REF GNB-166056000AA
*
* Total Messages:     0
* Data:        8648     Code:        4456
